{"ast":null,"code":"import React,{useCallback,useEffect,useState}from'react';import{core}from'@tauri-apps/api';import clipboard from'tauri-plugin-clipboard-api';import SignatureCard from'../../components/SignatureCard/SignatureCard';import viewStyles from'./SignatureView.module.css';import elements from'../../ui/elements.module.css';import{useToast}from'../../ui/toast';import{STRINGS}from'../../ui/strings';import{COLOURS}from'../../ui/theme/theme';import{CopyIcon20,EditIcon20,TrashIcon16,PlusIcon20}from'../../ui/icons';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LEFT_MIN_WIDTH=100;const GUTTER='1rem';const PREVIEW_MAX_WIDTH=450;const PREVIEW_BG=COLOURS.panel;const SIGNATURE_LOGO_WIDTH=300;export default function SignaturesView(){const[signatureName,setSignatureName]=useState('');const[name,setName]=useState('');const[position,setPosition]=useState('');const[department,setDepartment]=useState('');const[company,setCompany]=useState('');const[locations,setLocations]=useState({});const[selectedLocation,setSelectedLocation]=useState('');const[imageFileName,setImageFileName]=useState('');const[signatureList,setSignatureList]=useState([]);const[viewMode,setViewMode]=useState('preview');const[,setLastSelectedSignature]=useState(null);const[imageBase64,setImageBase64]=useState(null);const{showToast}=useToast();const handleSave=()=>{var _locations$selectedLo;const signature={signature_name:signatureName,name,position,department,company,location:{name:selectedLocation,address:(_locations$selectedLo=locations[selectedLocation])!==null&&_locations$selectedLo!==void 0?_locations$selectedLo:''},image_filename:imageFileName};core.invoke('save_signature_to_file',{signature}).then(()=>{showToast({message:STRINGS.savedChanges,variant:'success'});console.log('Signature saved to file!');reloadSignatureList();}).catch(err=>console.error('Failed to save signature:',err));};const reloadSignatureList=()=>{core.invoke('load_signatures').then(names=>{Promise.all(names.map(name=>core.invoke('load_signature_file',{name}).then(sig=>({signatureName:sig.signature_name,userName:sig.name})))).then(setSignatureList);}).catch(err=>console.error('Failed to reload signatures:',err));};const handleSelectSignature=useCallback(function(name){let mode=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'preview';// 1) Load the full signature file for this name\ncore.invoke('load_signature_file',{name}).then(sig=>{// 2) Populate UI state from the loaded signature\nsetSignatureName(sig.signature_name);setName(sig.name);setPosition(sig.position);setDepartment(sig.department);setCompany(sig.company);setSelectedLocation(sig.location.name);setImageFileName(sig.image_filename);setViewMode(mode);setLastSelectedSignature(name);// 3) Persist ONLY this view's last-selected field (safe partial update)\ncore.invoke('update_cache',{patch:{signature_view_last_selected_signature:name}}).catch(err=>console.error('Failed to update cache:',err));// 4) Load image (if any) as base64 for preview/copy\nif(sig.image_filename){core.invoke('get_signature_image_base64',{filename:sig.image_filename}).then(setImageBase64).catch(err=>{setImageBase64(null);console.error('Failed to load image:',err);});}else{setImageBase64(null);}}).catch(err=>console.error('Failed to load signature:',err));},[]// setters are stable; no deps needed. Keeps the callback identity stable.\n);const handleDeleteSignature=name=>{core.invoke('delete_signature_file',{name}).then(()=>{setSignatureList(prev=>prev.filter(sig=>sig.signatureName!==name));// optionally clear current preview if you deleted the currently open one...\nshowToast({message:STRINGS.deleted(name),variant:'success'});}).catch(err=>{console.error('Failed to delete signature:',err);showToast({message:'Failed to delete signature',variant:'danger'});});};const handleCreateNewSignature=()=>{// Clear all the form fields\nsetSignatureName('');setName('');setPosition('');setDepartment('');setCompany('');setSelectedLocation('');// or Object.keys(locations)[0] ?? '' if you want a default\nsetImageFileName('');setImageBase64(null);// Switch to edit mode so the user can fill it out\nsetViewMode('edit');// Do NOT touch lastSelectedSignature or save the cache here;\n// this is a new, unsaved draft.\n};const handleCopyToClipboard=async()=>{var _locations$selectedLo2;const html=`\n      <div>\n        <strong>${name}</strong><br/>\n        ${position}, ${department}<br/>\n        ${company}<br/>\n        ${(_locations$selectedLo2=locations[selectedLocation])!==null&&_locations$selectedLo2!==void 0?_locations$selectedLo2:''}<br/>\n        ${imageBase64?`\n                    <img\n                      src=\"data:image/png;base64,${imageBase64}\"\n                      width=\"${SIGNATURE_LOGO_WIDTH}\"\n                      style=\"display:block;width:${SIGNATURE_LOGO_WIDTH}px;height:auto;margin-top:1rem;border:0;outline:0;text-decoration:none;\"\n                      alt=\"Signature image\"\n                    />`:''}\n      </div>\n    `;try{await clipboard.writeHtml(html);showToast({message:STRINGS.copiedToClipboard,variant:'success'});console.log('Copied to clipboard!');}catch(err){console.error('Failed to copy to clipboard:',err);}};const handleImageUpload=e=>{var _e$target$files;const file=(_e$target$files=e.target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(file){setImageFileName(file.name);}};useEffect(()=>{core.invoke('load_cache').then(cache=>{if(cache.signature_view_last_selected_signature){setLastSelectedSignature(cache.signature_view_last_selected_signature);}}).catch(err=>console.error('Failed to load cache:',err));},[]);useEffect(()=>{core.invoke('load_signatures').then(names=>{Promise.all(names.map(name=>core.invoke('load_signature_file',{name}).then(sig=>({signatureName:sig.signature_name,userName:sig.name})))).then(list=>{setSignatureList(list);// Load cache and select signature\ncore.invoke('load_cache').then(cache=>{var _list$,_cache$signature_view;const fallback=(_list$=list[0])===null||_list$===void 0?void 0:_list$.signatureName;const toSelect=(_cache$signature_view=cache.signature_view_last_selected_signature)!==null&&_cache$signature_view!==void 0?_cache$signature_view:fallback;if(toSelect&&viewMode==='preview'){handleSelectSignature(toSelect,'preview');}}).catch(err=>console.error('Failed to load cache:',err));});}).catch(err=>console.error('Failed to load signatures:',err));},[handleSelectSignature,viewMode]);useEffect(()=>{core.invoke('load_locations').then(setLocations).catch(err=>console.error('Failed to load locations:',err));},[]);return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',height:'100%',padding:'1rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{minWidth:LEFT_MIN_WIDTH,flex:`1 1 ${LEFT_MIN_WIDTH}px`,// grows/shrinks but never below min\nborderRight:`1px solid ${COLOURS.divider}`,paddingRight:GUTTER,// padding on the left side of divider\noverflowY:'auto'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:'sticky',// stays visible while list scrolls\ntop:0,background:'#fff',padding:'0.25rem 0 0.5rem 0',display:'flex',alignItems:'center',justifyContent:'space-between',gap:'0.5rem',zIndex:1},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:0,fontSize:'0.875rem',fontWeight:600,color:'#374151'},children:\"Signatures\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",\"aria-label\":\"Create new signature\",title:\"Create new signature\",onClick:handleCreateNewSignature,style:{display:'inline-flex',alignItems:'center',justifyContent:'center',width:32,height:32,borderRadius:6,border:'1px solid #d0d7de',background:'#fff',color:'#111827',cursor:'pointer',boxShadow:'0 1px 2px rgba(0,0,0,0.04)',padding:0,userSelect:'none'},children:/*#__PURE__*/_jsx(PlusIcon20,{})})]}),signatureList.map(_ref=>{let{signatureName,userName}=_ref;return/*#__PURE__*/_jsx(SignatureCard,{signatureName:signatureName,userName:userName,onSelect:()=>handleSelectSignature(signatureName,'preview'),onEdit:()=>handleSelectSignature(signatureName,'edit'),onDelete:()=>handleDeleteSignature(signatureName)},signatureName);})]}),/*#__PURE__*/_jsx(\"div\",{style:{flex:'3 1 0',paddingLeft:GUTTER,overflowY:'auto'},children:viewMode==='preview'?/*#__PURE__*/// ==== PREVIEW CONTAINER ====\n_jsxs(\"div\",{style:{position:'relative',background:PREVIEW_BG,border:`1px solid ${COLOURS.divider}`,borderRadius:12,boxShadow:'0 1px 3px rgba(0,0,0,0.06)',padding:'1rem 1rem 1.25rem 1rem',maxWidth:PREVIEW_MAX_WIDTH,width:'100%'},children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',gap:'0.75rem',paddingRight:80// leave some breathing room so text doesn't collide with icons\n},children:/*#__PURE__*/_jsx(\"h3\",{title:signatureName||'Signature Preview',style:{margin:0,fontSize:'1.125rem',fontWeight:600,color:`${COLOURS.text}`,overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'},children:signatureName})}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',top:10,right:10,display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",\"aria-label\":\"Copy signature to clipboard\",title:\"Copy signature to clipboard\",onClick:handleCopyToClipboard,className:elements.iconBtn,children:/*#__PURE__*/_jsx(CopyIcon20,{})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",\"aria-label\":\"Edit signature\",title:\"Edit signature\",onClick:()=>setViewMode('edit'),className:elements.iconBtn,children:/*#__PURE__*/_jsx(EditIcon20,{})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",\"aria-label\":\"Delete signature\",title:\"Delete signature\",onClick:()=>signatureName&&handleDeleteSignature(signatureName),className:`${elements.iconBtn} ${viewStyles.danger}`,disabled:!signatureName,children:/*#__PURE__*/_jsx(TrashIcon16,{})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'0.75rem',lineHeight:1.5},children:[/*#__PURE__*/_jsxs(\"p\",{style:{margin:0},children:[/*#__PURE__*/_jsx(\"strong\",{children:name}),/*#__PURE__*/_jsx(\"br\",{}),position,\", \",department,/*#__PURE__*/_jsx(\"br\",{}),company,/*#__PURE__*/_jsx(\"br\",{}),locations[selectedLocation]]}),imageBase64&&/*#__PURE__*/_jsx(\"img\",{src:`data:image/png;base64,${imageBase64}`,alt:\"Signature\",style:{maxWidth:300,marginTop:'1rem'}})]})]}):/*#__PURE__*/// ==== EDIT VIEW ====\n_jsxs(\"div\",{style:{maxWidth:PREVIEW_MAX_WIDTH,width:'100%'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginTop:0},children:\"Create or Edit Signature\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>e.preventDefault(),children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'1rem'},children:[/*#__PURE__*/_jsx(\"label\",{className:elements.subtitle,children:\"Signature Name:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:signatureName,onChange:e=>setSignatureName(e.target.value),className:elements.input})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'1rem',marginBottom:'1rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsxs(\"label\",{className:elements.subtitle,children:[\"Name\",/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:\" *\"}),\":\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:name,onChange:e=>setName(e.target.value),className:elements.input})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsxs(\"label\",{className:elements.subtitle,children:[\"Position\",/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:\" *\"}),\":\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:position,onChange:e=>setPosition(e.target.value),className:elements.input})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'1rem',marginBottom:'1rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:elements.subtitle,children:\"Company:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:company,onChange:e=>setCompany(e.target.value),className:elements.input})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:elements.subtitle,children:\"Department:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:department,onChange:e=>setDepartment(e.target.value),className:elements.input})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'1rem',marginBottom:'1rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:elements.subtitle,children:\"Location:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"select\",{value:selectedLocation,onChange:e=>setSelectedLocation(e.target.value),className:elements.select,children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,value:\"\",children:\"-- Select Location --\"}),Object.entries(locations).map(_ref2=>{let[name,address]=_ref2;return/*#__PURE__*/_jsx(\"option\",{value:name,children:name},name);})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"label\",{className:elements.subtitle,children:\"Company Logo or Signature Image:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleImageUpload,className:elements.input})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'0.5rem'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleSave,children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setViewMode('preview'),children:\"Cancel\"})]})]})]})})]});}","map":{"version":3,"names":["React","useCallback","useEffect","useState","core","clipboard","SignatureCard","viewStyles","elements","useToast","STRINGS","COLOURS","CopyIcon20","EditIcon20","TrashIcon16","PlusIcon20","jsx","_jsx","jsxs","_jsxs","LEFT_MIN_WIDTH","GUTTER","PREVIEW_MAX_WIDTH","PREVIEW_BG","panel","SIGNATURE_LOGO_WIDTH","SignaturesView","signatureName","setSignatureName","name","setName","position","setPosition","department","setDepartment","company","setCompany","locations","setLocations","selectedLocation","setSelectedLocation","imageFileName","setImageFileName","signatureList","setSignatureList","viewMode","setViewMode","setLastSelectedSignature","imageBase64","setImageBase64","showToast","handleSave","_locations$selectedLo","signature","signature_name","location","address","image_filename","invoke","then","message","savedChanges","variant","console","log","reloadSignatureList","catch","err","error","names","Promise","all","map","sig","userName","handleSelectSignature","mode","arguments","length","undefined","patch","signature_view_last_selected_signature","filename","handleDeleteSignature","prev","filter","deleted","handleCreateNewSignature","handleCopyToClipboard","_locations$selectedLo2","html","writeHtml","copiedToClipboard","handleImageUpload","e","_e$target$files","file","target","files","cache","list","_list$","_cache$signature_view","fallback","toSelect","style","display","height","padding","children","minWidth","flex","borderRight","divider","paddingRight","overflowY","top","background","alignItems","justifyContent","gap","zIndex","margin","fontSize","fontWeight","color","type","title","onClick","width","borderRadius","border","cursor","boxShadow","userSelect","_ref","onSelect","onEdit","onDelete","paddingLeft","maxWidth","text","overflow","textOverflow","whiteSpace","right","className","iconBtn","danger","disabled","marginTop","lineHeight","src","alt","onSubmit","preventDefault","marginBottom","subtitle","value","onChange","input","select","Object","entries","_ref2","accept"],"sources":["C:/Users/lhaveman/email-generator/src/views/SignatureView/SignaturesView.tsx"],"sourcesContent":["\r\nimport React, { useCallback, useEffect, useState } from 'react';\r\nimport { core } from '@tauri-apps/api';\r\nimport clipboard from 'tauri-plugin-clipboard-api';\r\n\r\nimport SignatureCard from '../../components/SignatureCard/SignatureCard';\r\nimport viewStyles from './SignatureView.module.css';\r\n\r\nimport elements from '../../ui/elements.module.css';\r\n\r\nimport { useToast } from '../../ui/toast';\r\nimport { STRINGS } from '../../ui/strings';\r\nimport { COLOURS } from '../../ui/theme/theme';\r\nimport { CopyIcon20, EditIcon20, TrashIcon16, PlusIcon20 } from '../../ui/icons';\r\n\r\nconst LEFT_MIN_WIDTH = 100;\r\nconst GUTTER = '1rem';\r\nconst PREVIEW_MAX_WIDTH = 450;\r\nconst PREVIEW_BG = COLOURS.panel;\r\nconst SIGNATURE_LOGO_WIDTH = 300;\r\n\r\nexport default function SignaturesView() {\r\n\r\n  const [signatureName, setSignatureName] = useState('');\r\n  const [name, setName] = useState('');\r\n  const [position, setPosition] = useState('');\r\n  const [department, setDepartment] = useState('');\r\n  const [company, setCompany] = useState('');\r\n  const [locations, setLocations] = useState<Record<string, string>>({});\r\n  const [selectedLocation, setSelectedLocation] = useState('');\r\n  const [imageFileName, setImageFileName] = useState('');\r\n  const [signatureList, setSignatureList] = useState<\r\n    { signatureName: string; userName: string }[]\r\n  >([]);\r\n  const [viewMode, setViewMode] = useState<'preview' | 'edit'>('preview');\r\n  const [, setLastSelectedSignature] = useState<string | null>(null);\r\n  const [imageBase64, setImageBase64] = useState<string | null>(null);\r\n\r\n  const { showToast } = useToast();\r\n\r\n  interface Signature {\r\n  signature_name: string;\r\n  name: string;\r\n  position: string;\r\n  department: string;\r\n  company: string;\r\n  location: {\r\n    name: string;\r\n    address: string;\r\n  };\r\n  image_filename: string;\r\n  }\r\n\r\n  const handleSave = () => {\r\n    const signature = {\r\n      signature_name: signatureName,\r\n      name,\r\n      position,\r\n      department,\r\n      company,\r\n      location: {\r\n        name: selectedLocation,\r\n        address: locations[selectedLocation] ?? ''\r\n      },\r\n      image_filename: imageFileName\r\n    };\r\n\r\n    core.invoke('save_signature_to_file', { signature })\r\n      .then(() => {\r\n        showToast({ message: STRINGS.savedChanges, variant: 'success'}); \r\n        console.log('Signature saved to file!')\r\n        reloadSignatureList();\r\n      })\r\n      .catch(err => console.error('Failed to save signature:', err));\r\n  };\r\n\r\n  const reloadSignatureList = () => {\r\n    core.invoke<string[]>('load_signatures')\r\n      .then((names) => {\r\n        Promise.all(\r\n          names.map((name) =>\r\n            core.invoke<Signature>('load_signature_file', { name })\r\n              .then((sig) => ({\r\n                signatureName: sig.signature_name,\r\n                userName: sig.name,\r\n              }))\r\n          )\r\n        ).then(setSignatureList);\r\n      })\r\n      .catch((err) => console.error('Failed to reload signatures:', err));\r\n  };\r\n\r\n\r\n  const handleSelectSignature = useCallback(\r\n    (name: string, mode: 'preview' | 'edit' = 'preview') => {\r\n      // 1) Load the full signature file for this name\r\n      core\r\n        .invoke<Signature>('load_signature_file', { name })\r\n        .then((sig) => {\r\n          // 2) Populate UI state from the loaded signature\r\n          setSignatureName(sig.signature_name);\r\n          setName(sig.name);\r\n          setPosition(sig.position);\r\n          setDepartment(sig.department);\r\n          setCompany(sig.company);\r\n          setSelectedLocation(sig.location.name);\r\n          setImageFileName(sig.image_filename);\r\n          setViewMode(mode);\r\n          setLastSelectedSignature(name);\r\n\r\n          // 3) Persist ONLY this view's last-selected field (safe partial update)\r\n          core\r\n            .invoke('update_cache', {\r\n              patch: { signature_view_last_selected_signature: name },\r\n            })\r\n            .catch((err) => console.error('Failed to update cache:', err));\r\n\r\n          // 4) Load image (if any) as base64 for preview/copy\r\n          if (sig.image_filename) {\r\n            core\r\n              .invoke<string>('get_signature_image_base64', {\r\n                filename: sig.image_filename,\r\n              })\r\n              .then(setImageBase64)\r\n              .catch((err) => {\r\n                setImageBase64(null);\r\n                console.error('Failed to load image:', err);\r\n              });\r\n          } else {\r\n            setImageBase64(null);\r\n          }\r\n        })\r\n        .catch((err) => console.error('Failed to load signature:', err));\r\n    },\r\n    [] // setters are stable; no deps needed. Keeps the callback identity stable.\r\n  );\r\n\r\n\r\n  const handleDeleteSignature = (name: string) => {\r\n\r\n    core.invoke('delete_signature_file', { name })\r\n      .then(() => {\r\n        setSignatureList((prev) => prev.filter((sig) => sig.signatureName !== name));\r\n        // optionally clear current preview if you deleted the currently open one...\r\n        showToast({ message: STRINGS.deleted(name), variant: 'success' });\r\n      })\r\n      .catch((err) => {\r\n        console.error('Failed to delete signature:', err);\r\n        showToast({ message: 'Failed to delete signature', variant: 'danger' });\r\n      });\r\n  };\r\n\r\n  const handleCreateNewSignature = () => {\r\n  // Clear all the form fields\r\n  setSignatureName('');\r\n  setName('');\r\n  setPosition('');\r\n  setDepartment('');\r\n  setCompany('');\r\n  setSelectedLocation('');              // or Object.keys(locations)[0] ?? '' if you want a default\r\n  setImageFileName('');\r\n  setImageBase64(null);\r\n\r\n  // Switch to edit mode so the user can fill it out\r\n  setViewMode('edit');\r\n\r\n  // Do NOT touch lastSelectedSignature or save the cache here;\r\n  // this is a new, unsaved draft.\r\n  };\r\n\r\n  const handleCopyToClipboard = async () => {\r\n    const html = `\r\n      <div>\r\n        <strong>${name}</strong><br/>\r\n        ${position}, ${department}<br/>\r\n        ${company}<br/>\r\n        ${locations[selectedLocation] ?? ''}<br/>\r\n        ${\r\n          imageBase64\r\n                  ? `\r\n                    <img\r\n                      src=\"data:image/png;base64,${imageBase64}\"\r\n                      width=\"${SIGNATURE_LOGO_WIDTH}\"\r\n                      style=\"display:block;width:${SIGNATURE_LOGO_WIDTH}px;height:auto;margin-top:1rem;border:0;outline:0;text-decoration:none;\"\r\n                      alt=\"Signature image\"\r\n                    />`\r\n                  : ''\r\n        }\r\n      </div>\r\n    `;\r\n    try {\r\n      await clipboard.writeHtml(html);\r\n\r\n      showToast({ message: STRINGS.copiedToClipboard, variant: 'success'});\r\n      console.log('Copied to clipboard!');\r\n      \r\n    } catch (err) {\r\n      console.error('Failed to copy to clipboard:', err);\r\n    }\r\n  };\r\n\r\n  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      setImageFileName(file.name);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    core.invoke<{ signature_view_last_selected_signature: string | null }>('load_cache')\r\n      .then((cache) => {\r\n        if (cache.signature_view_last_selected_signature) {\r\n          setLastSelectedSignature(cache.signature_view_last_selected_signature);\r\n        }\r\n      }).catch((err) => console.error('Failed to load cache:', err));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    core.invoke<string[]>('load_signatures')\r\n      .then((names) => {\r\n        Promise.all(\r\n          names.map((name) =>\r\n            core.invoke<Signature>('load_signature_file', { name })\r\n              .then((sig) => ({\r\n                signatureName: sig.signature_name,\r\n                userName: sig.name,\r\n              }))\r\n          )\r\n        ).then((list) => {\r\n          setSignatureList(list);\r\n\r\n          // Load cache and select signature\r\n          core.invoke<{ signature_view_last_selected_signature: string | null }>('load_cache')\r\n            .then((cache) => {\r\n              const fallback = list[0]?.signatureName;\r\n              const toSelect = cache.signature_view_last_selected_signature ?? fallback;\r\n              if (toSelect && viewMode === 'preview') \r\n                {\r\n                  handleSelectSignature(toSelect, 'preview');\r\n                }\r\n            })\r\n            .catch((err) => console.error('Failed to load cache:', err));\r\n        });\r\n      })\r\n      .catch((err) => console.error('Failed to load signatures:', err));\r\n  }, [handleSelectSignature, viewMode]);\r\n\r\n\r\n  useEffect(() => {\r\n    core.invoke<Record<string, string>>('load_locations')\r\n      .then(setLocations)\r\n      .catch(err => console.error('Failed to load locations:', err));\r\n  }, []);\r\n\r\n  return (\r\n    <div \r\n      style=\r\n      {{ \r\n        display: 'flex', \r\n        height: '100%', \r\n        padding: '1rem' \r\n      }}\r\n    >\r\n      {/* Left column: for signature list */}\r\n      <div \r\n        style=\r\n        {{ \r\n          minWidth: LEFT_MIN_WIDTH,\r\n          flex: `1 1 ${LEFT_MIN_WIDTH}px`, // grows/shrinks but never below min\r\n          borderRight: `1px solid ${COLOURS.divider}`,\r\n          paddingRight: GUTTER, // padding on the left side of divider\r\n          overflowY: 'auto',\r\n        }}\r\n      > \r\n\r\n        {/* Left column header with + button */}\r\n        <div\r\n          style={{\r\n            position: 'sticky',   // stays visible while list scrolls\r\n            top: 0,\r\n            background: '#fff',\r\n            padding: '0.25rem 0 0.5rem 0',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between',\r\n            gap: '0.5rem',\r\n            zIndex: 1,\r\n          }}\r\n        >\r\n          <h4 style={{ margin: 0, fontSize: '0.875rem', fontWeight: 600, color: '#374151' }}>\r\n            Signatures\r\n          </h4>\r\n\r\n          <button\r\n            type=\"button\"\r\n            aria-label=\"Create new signature\"\r\n            title=\"Create new signature\"\r\n            onClick={handleCreateNewSignature}\r\n            style={{\r\n              display: 'inline-flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              width: 32,\r\n              height: 32,\r\n              borderRadius: 6,\r\n              border: '1px solid #d0d7de',\r\n              background: '#fff',\r\n              color: '#111827',\r\n              cursor: 'pointer',\r\n              boxShadow: '0 1px 2px rgba(0,0,0,0.04)',\r\n              padding: 0,\r\n              userSelect: 'none',\r\n            }}\r\n          >\r\n            {/* Plus Icon */}\r\n            <PlusIcon20/>\r\n          </button>\r\n        </div>\r\n   \r\n        {signatureList.map(({ signatureName, userName }) => (\r\n          <SignatureCard\r\n            key={signatureName}\r\n            signatureName={signatureName}\r\n            userName={userName}\r\n            onSelect={() => handleSelectSignature(signatureName, 'preview')}\r\n            onEdit={() => handleSelectSignature(signatureName, 'edit')}\r\n            onDelete={() => handleDeleteSignature(signatureName)}\r\n          />\r\n        ))}\r\n      </div>\r\n     \r\n      {/* Right column: Signature Preview */}      \r\n      <div style={{ flex: '3 1 0', paddingLeft: GUTTER, overflowY: 'auto' }}>\r\n        {viewMode === 'preview' ? (\r\n          // ==== PREVIEW CONTAINER ====\r\n          <div\r\n            style={{\r\n              position: 'relative',\r\n              background: PREVIEW_BG,\r\n              border: `1px solid ${COLOURS.divider}`,\r\n              borderRadius: 12,\r\n              boxShadow: '0 1px 3px rgba(0,0,0,0.06)',\r\n              padding: '1rem 1rem 1.25rem 1rem',\r\n              maxWidth: PREVIEW_MAX_WIDTH,\r\n              width: '100%',\r\n            }}\r\n          >\r\n            {/* Header: Title on the left, icon actions in the top-right */}\r\n            <div\r\n              style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '0.75rem',\r\n                paddingRight: 80, // leave some breathing room so text doesn't collide with icons\r\n              }}\r\n            >\r\n              <h3\r\n                title={signatureName || 'Signature Preview'}\r\n                style={{\r\n                  margin: 0,\r\n                  fontSize: '1.125rem',\r\n                  fontWeight: 600,\r\n                  color: `${COLOURS.text}`,\r\n                  overflow: 'hidden',\r\n                  textOverflow: 'ellipsis',\r\n                  whiteSpace: 'nowrap',\r\n                }}\r\n              >\r\n                {signatureName}\r\n              </h3>\r\n            </div>\r\n\r\n            {/* Icon toolbar (top-right corner) */}\r\n            <div\r\n              style={{\r\n                position: 'absolute',\r\n                top: 10,\r\n                right: 10,\r\n                display: 'flex',\r\n                gap: 8,\r\n              }}\r\n            >\r\n              {/* Copy */}\r\n              <button\r\n                type=\"button\"\r\n                aria-label=\"Copy signature to clipboard\"\r\n                title=\"Copy signature to clipboard\"\r\n                onClick={handleCopyToClipboard}\r\n                className={elements.iconBtn}\r\n              >\r\n                {/* Copy SVG */}\r\n                <CopyIcon20 />\r\n              </button>\r\n\r\n              {/* Edit */}\r\n              <button\r\n                type=\"button\"\r\n                aria-label=\"Edit signature\"\r\n                title=\"Edit signature\"\r\n                onClick={() => setViewMode('edit')}\r\n                className={elements.iconBtn}\r\n              >\r\n                {/* Edit SVG */}\r\n                <EditIcon20 />\r\n              </button>\r\n              \r\n                {/* Delete */}\r\n                <button\r\n                  type=\"button\"\r\n                  aria-label=\"Delete signature\"\r\n                  title=\"Delete signature\"\r\n                  onClick={() => signatureName && handleDeleteSignature(signatureName)}\r\n                  className={`${elements.iconBtn} ${viewStyles.danger}`}\r\n                  disabled={!signatureName}\r\n                >\r\n                  {/* Trash SVG */}\r\n                  <TrashIcon16 />\r\n                </button>\r\n            </div>\r\n\r\n            {/* Signature contents */}\r\n            <div style={{ marginTop: '0.75rem', lineHeight: 1.5 }}>\r\n              <p style={{ margin: 0 }}>\r\n                <strong>{name}</strong>\r\n                <br />\r\n                {position}, {department}\r\n                <br />\r\n                {company}\r\n                <br />\r\n                {locations[selectedLocation]}\r\n              </p>\r\n\r\n              {imageBase64 && (\r\n                <img\r\n                  src={`data:image/png;base64,${imageBase64}`}\r\n                  alt=\"Signature\"\r\n                  style={{ maxWidth: 300, marginTop: '1rem' }}\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          // ==== EDIT VIEW ====\r\n          <div style={{ maxWidth: PREVIEW_MAX_WIDTH, width: '100%' }}>\r\n            <h3 style={{ marginTop: 0 }}>Create or Edit Signature</h3>\r\n            <form onSubmit={(e) => e.preventDefault()}>\r\n              {/* Signature Name */}\r\n              <div style={{ marginBottom: '1rem' }}>\r\n                <label\r\n                  className= { elements.subtitle }\r\n                >\r\n                  Signature Name:\r\n                </label>\r\n                <br />\r\n                <input\r\n                  type=\"text\"\r\n                  value={signatureName}\r\n                  onChange={(e) => setSignatureName(e.target.value)}\r\n                  className= { elements.input }\r\n                />\r\n              </div>\r\n\r\n              {/* Name and Position */}\r\n              <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>\r\n                <div style={{ flex: 1 }}>\r\n                  <label\r\n                    className= { elements.subtitle }\r\n                  >\r\n                    Name<span style={{ color: 'red' }}> *</span>:\r\n                  </label>\r\n                  <br />\r\n                  <input\r\n                    type=\"text\"\r\n                    value= { name }\r\n                    onChange= {(e) => setName(e.target.value)}\r\n                    className= { elements.input }\r\n                  />\r\n                </div>\r\n                <div style={{ flex: 1 }}>\r\n                  <label \r\n                    className= { elements.subtitle }\r\n                  >\r\n                    Position<span style={{ color: 'red' }}> *</span>:\r\n                  </label>\r\n                  <br />\r\n                  <input\r\n                    type=\"text\"\r\n                    value={position}\r\n                    onChange={(e) => setPosition(e.target.value)}\r\n                    className= { elements.input }\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Company and Department */}\r\n              <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>\r\n                <div style={{ flex: 1 }}>\r\n                  <label \r\n                    className= { elements.subtitle }\r\n                  >\r\n                    Company:\r\n                  </label>\r\n                  <br />\r\n                  <input\r\n                    type=\"text\"\r\n                    value={company}\r\n                    onChange={(e) => setCompany(e.target.value)}\r\n                    className= { elements.input }\r\n                  />\r\n                </div>\r\n                <div style={{ flex: 1 }}>\r\n                  <label\r\n                    className= { elements.subtitle }\r\n                  >\r\n                    Department:\r\n                  </label>\r\n                  <br />\r\n                  <input\r\n                    type=\"text\"\r\n                    value={department}\r\n                    onChange={(e) => setDepartment(e.target.value)}\r\n                    className= { elements.input }\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Location Dropdown and File Picker */}\r\n              <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>\r\n                <div style={{ flex: 1 }}>\r\n                  <label\r\n                    className= { elements.subtitle }\r\n                  >\r\n                    Location:\r\n                  </label>\r\n                  <br />\r\n                  <select\r\n                    value={selectedLocation}\r\n                    onChange={(e) => setSelectedLocation(e.target.value)}\r\n                    className= { elements.select }\r\n                  >\r\n                    <option disabled value=\"\">\r\n                      -- Select Location --\r\n                    </option>\r\n                    {Object.entries(locations).map(([name, address]) => (\r\n                      <option key={name} value={name}>\r\n                        {name}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n                <div style={{ flex: 1 }}>\r\n                  <label\r\n                    className= { elements.subtitle }\r\n                  >\r\n                    Company Logo or Signature Image:\r\n                  </label>\r\n                  <br />\r\n                  <input\r\n                    type=\"file\"\r\n                    accept=\"image/*\"\r\n                    onChange={handleImageUpload}\r\n                    className= { elements.input }\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Save Button */}\r\n              <div style={{ display: 'flex', gap: '0.5rem' }}>\r\n                <button type=\"button\" onClick={handleSave}>\r\n                  Save\r\n                </button>\r\n                <button type=\"button\" onClick={() => setViewMode('preview')}>\r\n                  Cancel\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}