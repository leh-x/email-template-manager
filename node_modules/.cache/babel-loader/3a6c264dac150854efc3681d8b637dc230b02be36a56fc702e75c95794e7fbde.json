{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lhaveman\\\\email-generator\\\\src\\\\views\\\\EmailCompilerView.tsx\",\n  _s = $RefreshSig$();\n// src/views/EmailCompilerView/EmailCompilerView.tsx\nimport React, { useEffect, useState, useMemo } from 'react';\nimport { core } from '@tauri-apps/api';\nimport clipboard from 'tauri-plugin-clipboard-api';\nimport TemplateList from '../components/TemplateList/TemplateList';\nimport { CopyIcon20, SaveIcon24 } from '../ui/icons';\nimport { COLOURS } from '../ui/theme/theme';\nimport { useToast } from '../ui/toast';\nimport { STRINGS } from '../ui/strings';\nimport elements from '../ui/elements.module.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LEFT_MIN_WIDTH = 220;\nconst LEFT_MAX_WIDTH = 350;\nconst GUTTER = '1rem';\nconst EDITOR_MIN_HEIGHT = 220;\nconst SIGNATURE_LOGO_WIDTH = 300;\nexport default function EmailCompilerView() {\n  _s();\n  var _selectedTemplate$nam;\n  // Left column selection\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\n\n  // Editor body\n  const [templateBody, setTemplateBody] = useState('');\n\n  // Salutation / Valediction / Recipient\n  const [salutations, setSalutations] = useState([]);\n  const [valedictions, setValedictions] = useState([]);\n  const [selectedSalutation, setSelectedSalutation] = useState('');\n  const [selectedValediction, setSelectedValediction] = useState('');\n  const [recipient, setRecipient] = useState('');\n\n  // Signatures\n  const [signatureNames, setSignatureNames] = useState([]);\n  const [selectedSignatureName, setSelectedSignatureName] = useState('');\n  const [selectedSignature, setSelectedSignature] = useState(null);\n  const [signatureImageB64, setSignatureImageB64] = useState(null);\n  const {\n    showToast\n  } = useToast();\n  const [showPreview, setShowPreview] = useState(false);\n\n  // Load salutations, valedictions, and signature names\n  useEffect(() => {\n    // Load salutations and default to the first item (keep \"— none —\" as an explicit choice).\n    core.invoke('load_salutations').then(arr => {\n      setSalutations(arr);\n      setSelectedSalutation(prev => {\n        var _arr$;\n        return prev || ((_arr$ = arr[0]) !== null && _arr$ !== void 0 ? _arr$ : '');\n      });\n    }).catch(() => {\n      const fallback = ['Hello', 'Hi', 'Good morning'];\n      setSalutations(fallback);\n      setSelectedSalutation(prev => prev || fallback[0]);\n    });\n\n    // Load valedictions and default to the first item (keep \"— none —\" as an explicit choice).\n    core.invoke('load_valedictions').then(arr => {\n      setValedictions(arr);\n      setSelectedValediction(prev => {\n        var _arr$2;\n        return prev || ((_arr$2 = arr[0]) !== null && _arr$2 !== void 0 ? _arr$2 : '');\n      });\n    }).catch(() => {\n      const fallback = ['Thanks', 'Sincerely', 'Kind regards'];\n      setValedictions(fallback);\n      setSelectedValediction(prev => prev || fallback[0]);\n    });\n    core.invoke('load_signatures').then(setSignatureNames).catch(err => console.error('Failed to load signatures', err));\n  }, []);\n\n  // Handle template selection from the list\n  const handleSelectTemplate = tpl => {\n    setSelectedTemplate(tpl);\n    setTemplateBody(tpl.content);\n  };\n\n  // Persist changes to template body\n  const handleSaveTemplate = async () => {\n    if (!selectedTemplate) return;\n    try {\n      await core.invoke('save_template', {\n        name: selectedTemplate.name,\n        content: templateBody\n      });\n      showToast({\n        message: STRINGS.savedChanges,\n        variant: 'success'\n      });\n      // reflect last modified locally\n      setSelectedTemplate(prev => prev ? {\n        ...prev,\n        content: templateBody,\n        last_modified: new Date().toISOString()\n      } : prev);\n    } catch (err) {\n      console.error('Failed to save template', err);\n    }\n  };\n\n  // Load full signature when selection changes\n  useEffect(() => {\n    if (!selectedSignatureName) {\n      setSelectedSignature(null);\n      setSignatureImageB64(null);\n      return;\n    }\n    core.invoke('load_signature_file', {\n      name: selectedSignatureName\n    }).then(sig => {\n      setSelectedSignature(sig);\n      if (sig.image_filename) {\n        core.invoke('get_signature_image_base64', {\n          filename: sig.image_filename\n        }).then(setSignatureImageB64).catch(() => setSignatureImageB64(null));\n      } else {\n        setSignatureImageB64(null);\n      }\n    }).catch(err => console.error('Failed to load signature file', err));\n  }, [selectedSignatureName]);\n  useEffect(() => {\n    core.invoke('load_cache').then(cache => {\n      if (cache.email_view_last_selected_salutation) {\n        setSelectedSalutation(cache.email_view_last_selected_salutation);\n      }\n      if (cache.email_view_last_selected_valediction) {\n        setSelectedValediction(cache.email_view_last_selected_valediction);\n      }\n      if (cache.email_view_last_selected_signature) {\n        setSelectedSignatureName(cache.email_view_last_selected_signature);\n      }\n    }).catch(err => console.error('Failed to load cache:', err));\n  }, []);\n  useEffect(() => {\n    const t = setTimeout(() => {\n      const patch = {\n        email_view_last_selected_salutation: selectedSalutation || null,\n        email_view_last_selected_valediction: selectedValediction || null,\n        email_view_last_selected_signature: selectedSignatureName || null\n      };\n      core.invoke('update_cache', {\n        patch\n      }).catch(err => console.error('Failed to update cache:', err));\n    }, 300);\n    return () => clearTimeout(t);\n  }, [selectedSalutation, selectedValediction, selectedSignatureName]);\n\n  // Compose HTML + plaintext\n  const composed = useMemo(() => {\n    var _selectedSignature$lo, _selectedSignature$lo2;\n    const escapeHtml = s => s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n    const nl2br = s => escapeHtml(s).replace(/\\r?\\n/g, '<br/>');\n\n    // Inside useMemo(...)\n    const name = recipient.trim();\n\n    // Start from the selected salutation, but strip any trailing comma so we don't get \"Hello, Alex,\"\n    const salBase = (selectedSalutation || '').replace(/,\\s*$/, '').trim();\n\n    // If there's a name, append it with a single space; otherwise just use the salutation\n    const sal = salBase ? name ? `${salBase} ${name}` : salBase : '';\n\n    // \"ensure one comma\" rule still applies:\n    const salHtml = sal ? `<p>${nl2br(sal)}${sal.endsWith(',') ? '' : ','}</p>` : '';\n    const bodyHtml = `<div>${nl2br(templateBody)}</div>`;\n    const valHtml = selectedValediction ? `<p style=\"margin-top:1rem;\">${nl2br(selectedValediction)}${selectedValediction.endsWith(',') ? '' : ','}</p>` : '';\n    const sigHtml = ((_s$location$address, _s$location) => {\n      if (!selectedSignature) return '';\n      const s = selectedSignature;\n      const img = signatureImageB64 ? `<br><img src=\"data:image/png;base64,${signatureImageB64}\" width=\"${SIGNATURE_LOGO_WIDTH}\"\n                 style=\"display:block;width:${SIGNATURE_LOGO_WIDTH}px;height:auto;margin-top:1rem;border:0;outline:0;text-decoration:none;\"\n                 alt=\"Signature image\" />` : '';\n      return `\n        <div>\n          <strong>${escapeHtml(s.name)}</strong><br/>\n          ${escapeHtml(`${s.position}, ${s.department}`)}<br/>\n          ${escapeHtml(s.company)}<br/>\n          ${escapeHtml((_s$location$address = (_s$location = s.location) === null || _s$location === void 0 ? void 0 : _s$location.address) !== null && _s$location$address !== void 0 ? _s$location$address : '')}\n          ${img}\n        </div>\n      `;\n    })();\n    const html = `\n      <div style=\"font-family:-apple-system, Segoe UI, Roboto, Arial, sans-serif; color:#111827;\">\n        ${salHtml}${bodyHtml}${valHtml}${sigHtml}\n      </div>\n    `;\n    const plain = [sal ? sal.endsWith(',') ? sal : `${sal},` : '', templateBody, selectedValediction ? `${selectedValediction},` : '', selectedSignature ? [selectedSignature.name, `${selectedSignature.position}, ${selectedSignature.department}`, selectedSignature.company, (_selectedSignature$lo = (_selectedSignature$lo2 = selectedSignature.location) === null || _selectedSignature$lo2 === void 0 ? void 0 : _selectedSignature$lo2.address) !== null && _selectedSignature$lo !== void 0 ? _selectedSignature$lo : ''].filter(Boolean).join('\\n') : ''].filter(s => s && s.trim().length > 0).join('\\n\\n');\n    return {\n      html,\n      plain\n    };\n  }, [selectedSalutation, recipient, templateBody, selectedValediction, selectedSignature, signatureImageB64]);\n  const handleCopy = async () => {\n    try {\n      await clipboard.writeHtml(composed.html);\n      showToast({\n        message: STRINGS.copiedToClipboard,\n        variant: 'success'\n      });\n    } catch (err) {\n      console.error('Failed to copy composed email', err);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      height: '100dvh',\n      padding: '1rem',\n      boxSizing: 'border-box',\n      width: '100%' // helps avoid accidental expansion past viewport\n      // NOTE: do NOT set overflowX:'hidden' here if you want page-level horizontal\n      // scroll to be possible; keep default so only the *page* can scroll sideways.\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        // Give the column a responsive width that never exceeds LEFT_MAX_WIDTH\n        width: `clamp(${LEFT_MIN_WIDTH}px, 26vw, ${LEFT_MAX_WIDTH}px)`,\n        flex: '0 0 auto',\n        borderRight: `1px solid ${COLOURS.divider}`,\n        paddingRight: GUTTER,\n        overflowY: 'auto',\n        // independent vertical scroll\n        overflowX: 'hidden',\n        // never show a horizontal scrollbar here\n        minHeight: 0 // required for scroll inside flex child\n      },\n      children: /*#__PURE__*/_jsxDEV(TemplateList, {\n        selectedName: (_selectedTemplate$nam = selectedTemplate === null || selectedTemplate === void 0 ? void 0 : selectedTemplate.name) !== null && _selectedTemplate$nam !== void 0 ? _selectedTemplate$nam : null,\n        onSelectTemplate: handleSelectTemplate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: '1 1 auto',\n        minWidth: 0,\n        // <-- CRUCIAL: allow shrinking within flex\n        paddingLeft: GUTTER,\n        overflowY: 'auto',\n        // independent vertical scroll\n        overflowX: 'hidden' // never show a horizontal scrollbar here\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: 'min-content 3fr 0.5fr',\n          gap: 8,\n          marginBottom: 12,\n          alignItems: 'end'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: elements.subtitle,\n            children: \"Opening\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: selectedSalutation,\n            onChange: e => setSelectedSalutation(e.target.value),\n            className: elements.select,\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"\\u2014 none \\u2014\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 15\n            }, this), salutations.map(s => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: s,\n              children: s\n            }, s, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 39\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: elements.subtitle,\n            children: \"Recipient\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: recipient,\n            onChange: e => setRecipient(e.target.value),\n            placeholder: \"e.g., Alex\",\n            className: elements.input\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: elements.subtitle,\n          children: \"Template body\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'relative'\n            // allow the overlayed toolbar to stay within rounded corners if you wish\n            // overflow: 'hidden',\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: 'absolute',\n              top: 8,\n              right: 8,\n              display: 'flex',\n              gap: 8,\n              zIndex: 1\n            },\n            \"aria-label\": \"Editor toolbar\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: handleCopy,\n              className: elements.iconBtn,\n              title: \"Copy composed email\",\n              \"aria-label\": \"Copy composed email\",\n              children: /*#__PURE__*/_jsxDEV(CopyIcon20, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 354,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 347,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: handleSaveTemplate,\n              disabled: !selectedTemplate,\n              className: elements.iconBtn,\n              title: \"Save changed template\",\n              \"aria-label\": \"Save changed Template\",\n              children: /*#__PURE__*/_jsxDEV(SaveIcon24, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: templateBody,\n            onChange: e => setTemplateBody(e.target.value),\n            placeholder: selectedTemplate ? '' : 'Select a template to edit…',\n            readOnly: !selectedTemplate,\n            wrap: \"soft\",\n            style: {\n              boxSizing: 'border-box',\n              // prevents right-edge overflow\n              width: '100%',\n              maxWidth: '100%',\n              minHeight: EDITOR_MIN_HEIGHT,\n              maxHeight: '70vh',\n              padding: '44px 12px 12px 12px',\n              // <-- extra top padding for toolbar clearance\n              borderRadius: 8,\n              border: `1px solid ${COLOURS.border}`,\n              resize: 'vertical',\n              whiteSpace: 'pre-wrap',\n              overflowWrap: 'anywhere',\n              wordBreak: 'break-word',\n              fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Consolas, monospace',\n              fontSize: 14,\n              lineHeight: 1.5,\n              background: selectedTemplate ? '#fff' : '#f9fafb'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: 'min-content min-content 1fr',\n          gap: 8,\n          marginBottom: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: elements.subtitle,\n            children: \"Closing\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 408,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: selectedValediction,\n            onChange: e => setSelectedValediction(e.target.value),\n            className: elements.select,\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"\\u2014 none \\u2014\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 15\n            }, this), valedictions.map(v => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: v,\n              children: v\n            }, v, false, {\n              fileName: _jsxFileName,\n              lineNumber: 419,\n              columnNumber: 40\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: elements.subtitle,\n            children: \"Signature\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: selectedSignatureName,\n            onChange: e => setSelectedSignatureName(e.target.value),\n            className: elements.select,\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"\\u2014 none \\u2014\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 15\n            }, this), signatureNames.map(n => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: n,\n              children: n\n            }, n, false, {\n              fileName: _jsxFileName,\n              lineNumber: 437,\n              columnNumber: 42\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          borderTop: `1px solid ${COLOURS.divider}`,\n          marginTop: '1rem',\n          paddingTop: '0.5rem',\n          background: '#f3f4f6',\n          borderRadius: 8,\n          padding: '1rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            cursor: 'pointer'\n          },\n          onClick: () => setShowPreview(prev => !prev),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              alignItems: 'center',\n              gap: '0.5rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: elements.subtitle,\n              children: \"Preview\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                display: 'inline-block',\n                transition: 'transform 0.2s ease',\n                transform: showPreview ? 'rotate(90deg)' : 'rotate(0deg)'\n              },\n              children: \"\\u25B6\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 462,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: e => {\n              e.stopPropagation(); // prevent collapsing when clicking copy\n              handleCopy();\n            },\n            className: elements.iconBtn,\n            title: \"Copy composed email\",\n            \"aria-label\": \"Copy composed email\",\n            children: /*#__PURE__*/_jsxDEV(CopyIcon20, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 482,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 11\n        }, this), showPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: '1rem',\n            padding: '1rem',\n            border: `1px solid ${COLOURS.border}`,\n            borderRadius: 8,\n            background: '#fff',\n            fontFamily: 'sans-serif',\n            color: '#111827'\n          },\n          dangerouslySetInnerHTML: {\n            __html: composed.html\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 237,\n    columnNumber: 5\n  }, this);\n}\n_s(EmailCompilerView, \"rhzA19mVTvLMHvL2zthNI8LLWdY=\", false, function () {\n  return [useToast];\n});\n_c = EmailCompilerView;\nvar _c;\n$RefreshReg$(_c, \"EmailCompilerView\");","map":{"version":3,"names":["React","useEffect","useState","useMemo","core","clipboard","TemplateList","CopyIcon20","SaveIcon24","COLOURS","useToast","STRINGS","elements","jsxDEV","_jsxDEV","LEFT_MIN_WIDTH","LEFT_MAX_WIDTH","GUTTER","EDITOR_MIN_HEIGHT","SIGNATURE_LOGO_WIDTH","EmailCompilerView","_s","_selectedTemplate$nam","selectedTemplate","setSelectedTemplate","templateBody","setTemplateBody","salutations","setSalutations","valedictions","setValedictions","selectedSalutation","setSelectedSalutation","selectedValediction","setSelectedValediction","recipient","setRecipient","signatureNames","setSignatureNames","selectedSignatureName","setSelectedSignatureName","selectedSignature","setSelectedSignature","signatureImageB64","setSignatureImageB64","showToast","showPreview","setShowPreview","invoke","then","arr","prev","_arr$","catch","fallback","_arr$2","err","console","error","handleSelectTemplate","tpl","content","handleSaveTemplate","name","message","savedChanges","variant","last_modified","Date","toISOString","sig","image_filename","filename","cache","email_view_last_selected_salutation","email_view_last_selected_valediction","email_view_last_selected_signature","t","setTimeout","patch","clearTimeout","composed","_selectedSignature$lo","_selectedSignature$lo2","escapeHtml","s","replace","nl2br","trim","salBase","sal","salHtml","endsWith","bodyHtml","valHtml","sigHtml","_s$location$address","_s$location","img","position","department","company","location","address","html","plain","filter","Boolean","join","length","handleCopy","writeHtml","copiedToClipboard","style","display","height","padding","boxSizing","width","children","flex","borderRight","divider","paddingRight","overflowY","overflowX","minHeight","selectedName","onSelectTemplate","fileName","_jsxFileName","lineNumber","columnNumber","minWidth","paddingLeft","gridTemplateColumns","gap","marginBottom","alignItems","className","subtitle","value","onChange","e","target","select","map","type","placeholder","input","top","right","zIndex","onClick","iconBtn","title","disabled","readOnly","wrap","maxWidth","maxHeight","borderRadius","border","resize","whiteSpace","overflowWrap","wordBreak","fontFamily","fontSize","lineHeight","background","v","n","borderTop","marginTop","paddingTop","justifyContent","cursor","transition","transform","stopPropagation","color","dangerouslySetInnerHTML","__html","_c","$RefreshReg$"],"sources":["C:/Users/lhaveman/email-generator/src/views/EmailCompilerView.tsx"],"sourcesContent":["// src/views/EmailCompilerView/EmailCompilerView.tsx\r\nimport React, { useEffect, useState, useMemo } from 'react';\r\nimport { core } from '@tauri-apps/api';\r\nimport clipboard from 'tauri-plugin-clipboard-api';\r\nimport TemplateList, { TemplateFile } from '../components/TemplateList/TemplateList';\r\n\r\nimport { CopyIcon20, SaveIcon24 } from '../ui/icons';\r\nimport { COLOURS } from '../ui/theme/theme';\r\nimport { useToast } from '../ui/toast';\r\nimport { STRINGS } from '../ui/strings';\r\n\r\nimport elements from '../ui/elements.module.css';\r\n\r\ntype SignatureFile = {\r\n  signature_name: string;\r\n  name: string;\r\n  position: string;\r\n  department: string;\r\n  company: string;\r\n  location: { name: string; address: string };\r\n  image_filename: string | null;\r\n};\r\n\r\nconst LEFT_MIN_WIDTH = 220;\r\nconst LEFT_MAX_WIDTH = 350;\r\nconst GUTTER = '1rem';\r\nconst EDITOR_MIN_HEIGHT = 220;\r\nconst SIGNATURE_LOGO_WIDTH = 300;\r\n\r\nexport default function EmailCompilerView() {\r\n  // Left column selection\r\n  const [selectedTemplate, setSelectedTemplate] = useState<TemplateFile | null>(null);\r\n\r\n  // Editor body\r\n  const [templateBody, setTemplateBody] = useState('');\r\n\r\n  // Salutation / Valediction / Recipient\r\n  const [salutations, setSalutations] = useState<string[]>([]);\r\n  const [valedictions, setValedictions] = useState<string[]>([]);\r\n  const [selectedSalutation, setSelectedSalutation] = useState<string>('');\r\n  const [selectedValediction, setSelectedValediction] = useState<string>('');\r\n  const [recipient, setRecipient] = useState<string>('');\r\n\r\n  // Signatures\r\n  const [signatureNames, setSignatureNames] = useState<string[]>([]);\r\n  const [selectedSignatureName, setSelectedSignatureName] = useState<string>('');\r\n  const [selectedSignature, setSelectedSignature] = useState<SignatureFile | null>(null);\r\n  const [signatureImageB64, setSignatureImageB64] = useState<string | null>(null);\r\n\r\n  const { showToast } = useToast();\r\n  const [showPreview, setShowPreview] = useState(false);\r\n\r\n  // Load salutations, valedictions, and signature names\r\n  useEffect(() => {\r\n    // Load salutations and default to the first item (keep \"— none —\" as an explicit choice).\r\n    core.invoke<string[]>('load_salutations')\r\n      .then((arr) => {\r\n        setSalutations(arr);\r\n        setSelectedSalutation((prev) => prev || (arr[0] ?? ''));\r\n      })\r\n      .catch(() => {\r\n        const fallback = ['Hello', 'Hi', 'Good morning'];\r\n        setSalutations(fallback);\r\n        setSelectedSalutation((prev) => prev || fallback[0]);\r\n      });\r\n\r\n    // Load valedictions and default to the first item (keep \"— none —\" as an explicit choice).\r\n    core.invoke<string[]>('load_valedictions')\r\n      .then((arr) => {\r\n        setValedictions(arr);\r\n        setSelectedValediction((prev) => prev || (arr[0] ?? ''));\r\n      })\r\n      .catch(() => {\r\n        const fallback = ['Thanks', 'Sincerely', 'Kind regards'];\r\n        setValedictions(fallback);\r\n        setSelectedValediction((prev) => prev || fallback[0]);\r\n      });\r\n\r\n    core.invoke<string[]>('load_signatures')\r\n      .then(setSignatureNames)\r\n      .catch((err) => console.error('Failed to load signatures', err));\r\n  }, []);\r\n\r\n  // Handle template selection from the list\r\n  const handleSelectTemplate = (tpl: TemplateFile) => {\r\n    setSelectedTemplate(tpl);\r\n    setTemplateBody(tpl.content);\r\n  };\r\n\r\n  // Persist changes to template body\r\n  const handleSaveTemplate = async () => {\r\n    if (!selectedTemplate) return;\r\n    try {\r\n      await core.invoke('save_template', { name: selectedTemplate.name, content: templateBody });\r\n      showToast({ message: STRINGS.savedChanges, variant: 'success' });\r\n      // reflect last modified locally\r\n      setSelectedTemplate((prev) =>\r\n        prev ? { ...prev, content: templateBody, last_modified: new Date().toISOString() } : prev\r\n      );\r\n    } catch (err) {\r\n      console.error('Failed to save template', err);\r\n    }\r\n  };\r\n\r\n  // Load full signature when selection changes\r\n  useEffect(() => {\r\n    if (!selectedSignatureName) {\r\n      setSelectedSignature(null);\r\n      setSignatureImageB64(null);\r\n      return;\r\n    }\r\n    core.invoke<SignatureFile>('load_signature_file', { name: selectedSignatureName })\r\n      .then((sig) => {\r\n        setSelectedSignature(sig);\r\n        if (sig.image_filename) {\r\n          core.invoke<string>('get_signature_image_base64', { filename: sig.image_filename })\r\n            .then(setSignatureImageB64)\r\n            .catch(() => setSignatureImageB64(null));\r\n        } else {\r\n          setSignatureImageB64(null);\r\n        }\r\n      })\r\n      .catch((err) => console.error('Failed to load signature file', err));\r\n  }, [selectedSignatureName]);\r\n\r\n\r\n  useEffect(() => {\r\n    core.invoke<{\r\n      email_view_last_selected_signature: string | null,\r\n      email_view_last_selected_salutation: string | null,\r\n      email_view_last_selected_valediction: string | null\r\n    }>('load_cache')\r\n      .then((cache) => {\r\n        if (cache.email_view_last_selected_salutation) {\r\n          setSelectedSalutation(cache.email_view_last_selected_salutation);\r\n        }\r\n        if (cache.email_view_last_selected_valediction) {\r\n          setSelectedValediction(cache.email_view_last_selected_valediction);\r\n        }\r\n        if (cache.email_view_last_selected_signature) {\r\n          setSelectedSignatureName(cache.email_view_last_selected_signature);\r\n        }\r\n      })\r\n      .catch((err) => console.error('Failed to load cache:', err));\r\n  }, []);\r\n\r\n\r\n  useEffect(() => {\r\n    const t = setTimeout(() => {\r\n      const patch: Record<string, string | null> = {\r\n        email_view_last_selected_salutation: selectedSalutation || null,\r\n        email_view_last_selected_valediction: selectedValediction || null,\r\n        email_view_last_selected_signature: selectedSignatureName || null,\r\n      };\r\n      core.invoke('update_cache', { patch })\r\n        .catch(err => console.error('Failed to update cache:', err));\r\n    }, 300);\r\n    return () => clearTimeout(t);\r\n  }, [selectedSalutation, selectedValediction, selectedSignatureName]);\r\n\r\n\r\n  // Compose HTML + plaintext\r\n  const composed = useMemo(() => {\r\n    const escapeHtml = (s: string) =>\r\n      s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n\r\n    const nl2br = (s: string) => escapeHtml(s).replace(/\\r?\\n/g, '<br/>');\r\n\r\n    // Inside useMemo(...)\r\n    const name = recipient.trim();\r\n\r\n    // Start from the selected salutation, but strip any trailing comma so we don't get \"Hello, Alex,\"\r\n    const salBase = (selectedSalutation || '').replace(/,\\s*$/, '').trim();\r\n\r\n    // If there's a name, append it with a single space; otherwise just use the salutation\r\n    const sal = salBase ? (name ? `${salBase} ${name}` : salBase) : '';\r\n\r\n    // \"ensure one comma\" rule still applies:\r\n    const salHtml = sal ? `<p>${nl2br(sal)}${sal.endsWith(',') ? '' : ','}</p>` : '';\r\n    const bodyHtml = `<div>${nl2br(templateBody)}</div>`;\r\n    const valHtml = selectedValediction ? `<p style=\"margin-top:1rem;\">${nl2br(selectedValediction)}${selectedValediction.endsWith(',') ? '' : ','}</p>` : '';\r\n\r\n    const sigHtml = (() => {\r\n      if (!selectedSignature) return '';\r\n      const s = selectedSignature;\r\n      const img = signatureImageB64\r\n        ? `<br><img src=\"data:image/png;base64,${signatureImageB64}\" width=\"${SIGNATURE_LOGO_WIDTH}\"\r\n                 style=\"display:block;width:${SIGNATURE_LOGO_WIDTH}px;height:auto;margin-top:1rem;border:0;outline:0;text-decoration:none;\"\r\n                 alt=\"Signature image\" />`\r\n        : '';\r\n      return `\r\n        <div>\r\n          <strong>${escapeHtml(s.name)}</strong><br/>\r\n          ${escapeHtml(`${s.position}, ${s.department}`)}<br/>\r\n          ${escapeHtml(s.company)}<br/>\r\n          ${escapeHtml(s.location?.address ?? '')}\r\n          ${img}\r\n        </div>\r\n      `;\r\n    })();\r\n\r\n    const html = `\r\n      <div style=\"font-family:-apple-system, Segoe UI, Roboto, Arial, sans-serif; color:#111827;\">\r\n        ${salHtml}${bodyHtml}${valHtml}${sigHtml}\r\n      </div>\r\n    `;\r\n\r\n    const plain = [\r\n      sal ? (sal.endsWith(',') ? sal : `${sal},`) : '',\r\n      templateBody,\r\n      selectedValediction ? `${selectedValediction},` : '',\r\n      selectedSignature\r\n        ? [\r\n            selectedSignature.name,\r\n            `${selectedSignature.position}, ${selectedSignature.department}`,\r\n            selectedSignature.company,\r\n            selectedSignature.location?.address ?? '',\r\n          ].filter(Boolean).join('\\n')\r\n        : '',\r\n    ]\r\n      .filter((s) => s && s.trim().length > 0)\r\n      .join('\\n\\n');\r\n\r\n    return { html, plain };\r\n  }, [selectedSalutation, recipient, templateBody, selectedValediction, selectedSignature, signatureImageB64]);\r\n\r\n  const handleCopy = async () => {\r\n    try {\r\n      await clipboard.writeHtml(composed.html);\r\n      showToast({ message: STRINGS.copiedToClipboard, variant: 'success' });\r\n    } catch (err) {\r\n      console.error('Failed to copy composed email', err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div \r\n      style={{ \r\n        display: 'flex', \r\n        height: '100dvh', \r\n        padding: '1rem',\r\n        boxSizing: 'border-box',\r\n        width: '100%',                  // helps avoid accidental expansion past viewport\r\n      // NOTE: do NOT set overflowX:'hidden' here if you want page-level horizontal\r\n      // scroll to be possible; keep default so only the *page* can scroll sideways.\r\n      }}\r\n    >\r\n      {/* LEFT: reuse TemplateList (Templates + search + favourites) */}\r\n      <div\r\n        style={{\r\n          // Give the column a responsive width that never exceeds LEFT_MAX_WIDTH\r\n          width: `clamp(${LEFT_MIN_WIDTH}px, 26vw, ${LEFT_MAX_WIDTH}px)`,\r\n          flex: '0 0 auto',\r\n          borderRight: `1px solid ${COLOURS.divider}`,\r\n          paddingRight: GUTTER,\r\n          overflowY: 'auto',                // independent vertical scroll\r\n          overflowX: 'hidden',              // never show a horizontal scrollbar here\r\n          minHeight: 0,                     // required for scroll inside flex child\r\n        }}\r\n      >\r\n        <TemplateList\r\n          selectedName={selectedTemplate?.name ?? null}\r\n          onSelectTemplate={handleSelectTemplate}\r\n        />\r\n      </div>\r\n\r\n      {/* RIGHT: Composer */}\r\n      <div \r\n        style={{ \r\n          flex: '1 1 auto', \r\n          minWidth: 0,                      // <-- CRUCIAL: allow shrinking within flex\r\n          paddingLeft: GUTTER,\r\n          overflowY: 'auto',                // independent vertical scroll\r\n          overflowX: 'hidden',              // never show a horizontal scrollbar here\r\n        }}\r\n      >\r\n        {/* Row 1: Salutation + Recipient + Copy */}\r\n        <div \r\n          style={{ \r\n            display: 'grid', \r\n            gridTemplateColumns: 'min-content 3fr 0.5fr', \r\n            gap: 8, \r\n            marginBottom: 12, \r\n            alignItems: 'end' }}>\r\n          <div>\r\n            <label\r\n              className= { elements.subtitle }\r\n            >\r\n              Opening\r\n            </label>\r\n\r\n            <select\r\n              value={selectedSalutation}\r\n              onChange={(e) => setSelectedSalutation(e.target.value)}\r\n              className= { elements.select }\r\n            >\r\n              <option value=\"\">— none —</option>\r\n              {salutations.map((s) => <option key={s} value={s}>{s}</option>)}\r\n            </select>\r\n          </div>\r\n\r\n\r\n          <div>\r\n            <label \r\n              className= { elements.subtitle }\r\n            >\r\n              Recipient\r\n            </label>\r\n\r\n            <input\r\n              type=\"text\"\r\n              value={recipient}\r\n              onChange={(e) => setRecipient(e.target.value)}\r\n              placeholder=\"e.g., Alex\"\r\n              className= { elements.input }\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Row 2: Template editor + Save */}\r\n        <div style={{ marginBottom: 12 }}>\r\n          <label\r\n            className= { elements.subtitle }\r\n          >\r\n            Template body\r\n          </label>\r\n\r\n          <div\r\n              style={{\r\n                position: 'relative',\r\n                // allow the overlayed toolbar to stay within rounded corners if you wish\r\n                // overflow: 'hidden',\r\n              }}\r\n            >\r\n              {/* Floating toolbar – visually inside the editor area */}\r\n              <div\r\n                style={{\r\n                  position: 'absolute',\r\n                  top: 8,\r\n                  right: 8,\r\n                  display: 'flex',\r\n                  gap: 8,\r\n                  zIndex: 1,\r\n                }}\r\n                aria-label=\"Editor toolbar\"\r\n              >\r\n                <button\r\n                  type=\"button\"\r\n                  onClick= { handleCopy }\r\n                  className= { elements.iconBtn }\r\n                  title=\"Copy composed email\"\r\n                  aria-label=\"Copy composed email\"\r\n                >\r\n                  <CopyIcon20 />\r\n                </button>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  onClick= { handleSaveTemplate }\r\n                  disabled= { !selectedTemplate }\r\n                  className= { elements.iconBtn }\r\n                  title=\"Save changed template\"\r\n                  aria-label=\"Save changed Template\"\r\n                >\r\n                  <SaveIcon24/>\r\n                </button>\r\n              </div>\r\n\r\n              {/* The textarea gets extra top padding so text never hides under the toolbar */}\r\n              <textarea\r\n                value={templateBody}\r\n                onChange={(e) => setTemplateBody(e.target.value)}\r\n                placeholder={selectedTemplate ? '' : 'Select a template to edit…'}\r\n                readOnly={!selectedTemplate}\r\n                wrap=\"soft\"\r\n                style={{\r\n                  boxSizing: 'border-box',  // prevents right-edge overflow\r\n                  width: '100%',\r\n                  maxWidth: '100%',\r\n                  minHeight: EDITOR_MIN_HEIGHT,\r\n                  maxHeight: '70vh',\r\n                  padding: '44px 12px 12px 12px', // <-- extra top padding for toolbar clearance\r\n                  borderRadius: 8,\r\n                  border: `1px solid ${COLOURS.border}`,\r\n                  resize: 'vertical',\r\n                  whiteSpace: 'pre-wrap',\r\n                  overflowWrap: 'anywhere',\r\n                  wordBreak: 'break-word',\r\n                  fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Consolas, monospace',\r\n                  fontSize: 14,\r\n                  lineHeight: 1.5,\r\n                  background: selectedTemplate ? '#fff' : '#f9fafb',\r\n                }}\r\n              />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Row 3: Valediction */}\r\n        <div \r\n          style={{ \r\n            display: 'grid', \r\n            gridTemplateColumns: 'min-content min-content 1fr', \r\n            gap: 8, \r\n            marginBottom: 12 \r\n          }}\r\n        >\r\n          <div>\r\n            <label \r\n              className= { elements.subtitle }\r\n            >\r\n              Closing\r\n            </label>\r\n            <select\r\n              value={selectedValediction}\r\n              onChange={(e) => setSelectedValediction(e.target.value)}\r\n              className= { elements.select }\r\n            >\r\n              <option value=\"\">— none —</option>\r\n              {valedictions.map((v) => <option key={v} value={v}>{v}</option>)}\r\n            </select>\r\n          </div>\r\n\r\n          {/* Row 4: Signature */}\r\n          <div>\r\n            <label \r\n              className= { elements.subtitle }\r\n            >\r\n              Signature\r\n            </label>\r\n\r\n            <select\r\n              value={selectedSignatureName}\r\n              onChange={(e) => setSelectedSignatureName(e.target.value)}\r\n              className= { elements.select }\r\n            >\r\n              <option value=\"\">— none —</option>\r\n              {signatureNames.map((n) => <option key={n} value={n}>{n}</option>)}\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div\r\n          style={{\r\n            borderTop: `1px solid ${COLOURS.divider}`,\r\n            marginTop: '1rem',\r\n            paddingTop: '0.5rem',\r\n            background: '#f3f4f6',\r\n            borderRadius: 8,\r\n            padding: '1rem'\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              display: 'flex',\r\n              justifyContent: 'space-between',\r\n              alignItems: 'center',\r\n              cursor: 'pointer'\r\n            }}\r\n            onClick={() => setShowPreview(prev => !prev)}\r\n          >\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\r\n              <span className={elements.subtitle}>Preview</span>\r\n              <span\r\n                style={{\r\n                  display: 'inline-block',\r\n                  transition: 'transform 0.2s ease',\r\n                  transform: showPreview ? 'rotate(90deg)' : 'rotate(0deg)'\r\n                }}\r\n              >\r\n                ▶\r\n              </span>\r\n            </div>\r\n            <button\r\n              type=\"button\"\r\n              onClick={(e) => {\r\n                e.stopPropagation(); // prevent collapsing when clicking copy\r\n                handleCopy();\r\n              }}\r\n              className={elements.iconBtn}\r\n              title=\"Copy composed email\"\r\n              aria-label=\"Copy composed email\"\r\n            >\r\n              <CopyIcon20 />\r\n            </button>\r\n          </div>\r\n\r\n          {showPreview && (\r\n            <div\r\n              style={{\r\n                marginTop: '1rem',\r\n                padding: '1rem',\r\n                border: `1px solid ${COLOURS.border}`,\r\n                borderRadius: 8,\r\n                background: '#fff',\r\n                fontFamily: 'sans-serif',\r\n                color: '#111827'\r\n              }}\r\n              dangerouslySetInnerHTML={{ __html: composed.html }}\r\n            />\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,EAAEC,OAAO,QAAQ,OAAO;AAC3D,SAASC,IAAI,QAAQ,iBAAiB;AACtC,OAAOC,SAAS,MAAM,4BAA4B;AAClD,OAAOC,YAAY,MAAwB,yCAAyC;AAEpF,SAASC,UAAU,EAAEC,UAAU,QAAQ,aAAa;AACpD,SAASC,OAAO,QAAQ,mBAAmB;AAC3C,SAASC,QAAQ,QAAQ,aAAa;AACtC,SAASC,OAAO,QAAQ,eAAe;AAEvC,OAAOC,QAAQ,MAAM,2BAA2B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAYjD,MAAMC,cAAc,GAAG,GAAG;AAC1B,MAAMC,cAAc,GAAG,GAAG;AAC1B,MAAMC,MAAM,GAAG,MAAM;AACrB,MAAMC,iBAAiB,GAAG,GAAG;AAC7B,MAAMC,oBAAoB,GAAG,GAAG;AAEhC,eAAe,SAASC,iBAAiBA,CAAA,EAAG;EAAAC,EAAA;EAAA,IAAAC,qBAAA;EAC1C;EACA,MAAM,CAACC,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGtB,QAAQ,CAAsB,IAAI,CAAC;;EAEnF;EACA,MAAM,CAACuB,YAAY,EAAEC,eAAe,CAAC,GAAGxB,QAAQ,CAAC,EAAE,CAAC;;EAEpD;EACA,MAAM,CAACyB,WAAW,EAAEC,cAAc,CAAC,GAAG1B,QAAQ,CAAW,EAAE,CAAC;EAC5D,MAAM,CAAC2B,YAAY,EAAEC,eAAe,CAAC,GAAG5B,QAAQ,CAAW,EAAE,CAAC;EAC9D,MAAM,CAAC6B,kBAAkB,EAAEC,qBAAqB,CAAC,GAAG9B,QAAQ,CAAS,EAAE,CAAC;EACxE,MAAM,CAAC+B,mBAAmB,EAAEC,sBAAsB,CAAC,GAAGhC,QAAQ,CAAS,EAAE,CAAC;EAC1E,MAAM,CAACiC,SAAS,EAAEC,YAAY,CAAC,GAAGlC,QAAQ,CAAS,EAAE,CAAC;;EAEtD;EACA,MAAM,CAACmC,cAAc,EAAEC,iBAAiB,CAAC,GAAGpC,QAAQ,CAAW,EAAE,CAAC;EAClE,MAAM,CAACqC,qBAAqB,EAAEC,wBAAwB,CAAC,GAAGtC,QAAQ,CAAS,EAAE,CAAC;EAC9E,MAAM,CAACuC,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGxC,QAAQ,CAAuB,IAAI,CAAC;EACtF,MAAM,CAACyC,iBAAiB,EAAEC,oBAAoB,CAAC,GAAG1C,QAAQ,CAAgB,IAAI,CAAC;EAE/E,MAAM;IAAE2C;EAAU,CAAC,GAAGnC,QAAQ,CAAC,CAAC;EAChC,MAAM,CAACoC,WAAW,EAAEC,cAAc,CAAC,GAAG7C,QAAQ,CAAC,KAAK,CAAC;;EAErD;EACAD,SAAS,CAAC,MAAM;IACd;IACAG,IAAI,CAAC4C,MAAM,CAAW,kBAAkB,CAAC,CACtCC,IAAI,CAAEC,GAAG,IAAK;MACbtB,cAAc,CAACsB,GAAG,CAAC;MACnBlB,qBAAqB,CAAEmB,IAAI;QAAA,IAAAC,KAAA;QAAA,OAAKD,IAAI,MAAAC,KAAA,GAAKF,GAAG,CAAC,CAAC,CAAC,cAAAE,KAAA,cAAAA,KAAA,GAAI,EAAE,CAAC;MAAA,EAAC;IACzD,CAAC,CAAC,CACDC,KAAK,CAAC,MAAM;MACX,MAAMC,QAAQ,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,cAAc,CAAC;MAChD1B,cAAc,CAAC0B,QAAQ,CAAC;MACxBtB,qBAAqB,CAAEmB,IAAI,IAAKA,IAAI,IAAIG,QAAQ,CAAC,CAAC,CAAC,CAAC;IACtD,CAAC,CAAC;;IAEJ;IACAlD,IAAI,CAAC4C,MAAM,CAAW,mBAAmB,CAAC,CACvCC,IAAI,CAAEC,GAAG,IAAK;MACbpB,eAAe,CAACoB,GAAG,CAAC;MACpBhB,sBAAsB,CAAEiB,IAAI;QAAA,IAAAI,MAAA;QAAA,OAAKJ,IAAI,MAAAI,MAAA,GAAKL,GAAG,CAAC,CAAC,CAAC,cAAAK,MAAA,cAAAA,MAAA,GAAI,EAAE,CAAC;MAAA,EAAC;IAC1D,CAAC,CAAC,CACDF,KAAK,CAAC,MAAM;MACX,MAAMC,QAAQ,GAAG,CAAC,QAAQ,EAAE,WAAW,EAAE,cAAc,CAAC;MACxDxB,eAAe,CAACwB,QAAQ,CAAC;MACzBpB,sBAAsB,CAAEiB,IAAI,IAAKA,IAAI,IAAIG,QAAQ,CAAC,CAAC,CAAC,CAAC;IACvD,CAAC,CAAC;IAEJlD,IAAI,CAAC4C,MAAM,CAAW,iBAAiB,CAAC,CACrCC,IAAI,CAACX,iBAAiB,CAAC,CACvBe,KAAK,CAAEG,GAAG,IAAKC,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEF,GAAG,CAAC,CAAC;EACpE,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMG,oBAAoB,GAAIC,GAAiB,IAAK;IAClDpC,mBAAmB,CAACoC,GAAG,CAAC;IACxBlC,eAAe,CAACkC,GAAG,CAACC,OAAO,CAAC;EAC9B,CAAC;;EAED;EACA,MAAMC,kBAAkB,GAAG,MAAAA,CAAA,KAAY;IACrC,IAAI,CAACvC,gBAAgB,EAAE;IACvB,IAAI;MACF,MAAMnB,IAAI,CAAC4C,MAAM,CAAC,eAAe,EAAE;QAAEe,IAAI,EAAExC,gBAAgB,CAACwC,IAAI;QAAEF,OAAO,EAAEpC;MAAa,CAAC,CAAC;MAC1FoB,SAAS,CAAC;QAAEmB,OAAO,EAAErD,OAAO,CAACsD,YAAY;QAAEC,OAAO,EAAE;MAAU,CAAC,CAAC;MAChE;MACA1C,mBAAmB,CAAE2B,IAAI,IACvBA,IAAI,GAAG;QAAE,GAAGA,IAAI;QAAEU,OAAO,EAAEpC,YAAY;QAAE0C,aAAa,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;MAAE,CAAC,GAAGlB,IACvF,CAAC;IACH,CAAC,CAAC,OAAOK,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEF,GAAG,CAAC;IAC/C;EACF,CAAC;;EAED;EACAvD,SAAS,CAAC,MAAM;IACd,IAAI,CAACsC,qBAAqB,EAAE;MAC1BG,oBAAoB,CAAC,IAAI,CAAC;MAC1BE,oBAAoB,CAAC,IAAI,CAAC;MAC1B;IACF;IACAxC,IAAI,CAAC4C,MAAM,CAAgB,qBAAqB,EAAE;MAAEe,IAAI,EAAExB;IAAsB,CAAC,CAAC,CAC/EU,IAAI,CAAEqB,GAAG,IAAK;MACb5B,oBAAoB,CAAC4B,GAAG,CAAC;MACzB,IAAIA,GAAG,CAACC,cAAc,EAAE;QACtBnE,IAAI,CAAC4C,MAAM,CAAS,4BAA4B,EAAE;UAAEwB,QAAQ,EAAEF,GAAG,CAACC;QAAe,CAAC,CAAC,CAChFtB,IAAI,CAACL,oBAAoB,CAAC,CAC1BS,KAAK,CAAC,MAAMT,oBAAoB,CAAC,IAAI,CAAC,CAAC;MAC5C,CAAC,MAAM;QACLA,oBAAoB,CAAC,IAAI,CAAC;MAC5B;IACF,CAAC,CAAC,CACDS,KAAK,CAAEG,GAAG,IAAKC,OAAO,CAACC,KAAK,CAAC,+BAA+B,EAAEF,GAAG,CAAC,CAAC;EACxE,CAAC,EAAE,CAACjB,qBAAqB,CAAC,CAAC;EAG3BtC,SAAS,CAAC,MAAM;IACdG,IAAI,CAAC4C,MAAM,CAIR,YAAY,CAAC,CACbC,IAAI,CAAEwB,KAAK,IAAK;MACf,IAAIA,KAAK,CAACC,mCAAmC,EAAE;QAC7C1C,qBAAqB,CAACyC,KAAK,CAACC,mCAAmC,CAAC;MAClE;MACA,IAAID,KAAK,CAACE,oCAAoC,EAAE;QAC9CzC,sBAAsB,CAACuC,KAAK,CAACE,oCAAoC,CAAC;MACpE;MACA,IAAIF,KAAK,CAACG,kCAAkC,EAAE;QAC5CpC,wBAAwB,CAACiC,KAAK,CAACG,kCAAkC,CAAC;MACpE;IACF,CAAC,CAAC,CACDvB,KAAK,CAAEG,GAAG,IAAKC,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAEF,GAAG,CAAC,CAAC;EAChE,CAAC,EAAE,EAAE,CAAC;EAGNvD,SAAS,CAAC,MAAM;IACd,MAAM4E,CAAC,GAAGC,UAAU,CAAC,MAAM;MACzB,MAAMC,KAAoC,GAAG;QAC3CL,mCAAmC,EAAE3C,kBAAkB,IAAI,IAAI;QAC/D4C,oCAAoC,EAAE1C,mBAAmB,IAAI,IAAI;QACjE2C,kCAAkC,EAAErC,qBAAqB,IAAI;MAC/D,CAAC;MACDnC,IAAI,CAAC4C,MAAM,CAAC,cAAc,EAAE;QAAE+B;MAAM,CAAC,CAAC,CACnC1B,KAAK,CAACG,GAAG,IAAIC,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEF,GAAG,CAAC,CAAC;IAChE,CAAC,EAAE,GAAG,CAAC;IACP,OAAO,MAAMwB,YAAY,CAACH,CAAC,CAAC;EAC9B,CAAC,EAAE,CAAC9C,kBAAkB,EAAEE,mBAAmB,EAAEM,qBAAqB,CAAC,CAAC;;EAGpE;EACA,MAAM0C,QAAQ,GAAG9E,OAAO,CAAC,MAAM;IAAA,IAAA+E,qBAAA,EAAAC,sBAAA;IAC7B,MAAMC,UAAU,GAAIC,CAAS,IAC3BA,CAAC,CAACC,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC;IAEtE,MAAMC,KAAK,GAAIF,CAAS,IAAKD,UAAU,CAACC,CAAC,CAAC,CAACC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC;;IAErE;IACA,MAAMvB,IAAI,GAAG5B,SAAS,CAACqD,IAAI,CAAC,CAAC;;IAE7B;IACA,MAAMC,OAAO,GAAG,CAAC1D,kBAAkB,IAAI,EAAE,EAAEuD,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAACE,IAAI,CAAC,CAAC;;IAEtE;IACA,MAAME,GAAG,GAAGD,OAAO,GAAI1B,IAAI,GAAG,GAAG0B,OAAO,IAAI1B,IAAI,EAAE,GAAG0B,OAAO,GAAI,EAAE;;IAElE;IACA,MAAME,OAAO,GAAGD,GAAG,GAAG,MAAMH,KAAK,CAACG,GAAG,CAAC,GAAGA,GAAG,CAACE,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,GAAG,MAAM,GAAG,EAAE;IAChF,MAAMC,QAAQ,GAAG,QAAQN,KAAK,CAAC9D,YAAY,CAAC,QAAQ;IACpD,MAAMqE,OAAO,GAAG7D,mBAAmB,GAAG,+BAA+BsD,KAAK,CAACtD,mBAAmB,CAAC,GAAGA,mBAAmB,CAAC2D,QAAQ,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,GAAG,MAAM,GAAG,EAAE;IAEzJ,MAAMG,OAAO,GAAG,CAAC,CAAAC,mBAAA,EAAAC,WAAA,KAAM;MACrB,IAAI,CAACxD,iBAAiB,EAAE,OAAO,EAAE;MACjC,MAAM4C,CAAC,GAAG5C,iBAAiB;MAC3B,MAAMyD,GAAG,GAAGvD,iBAAiB,GACzB,uCAAuCA,iBAAiB,YAAYxB,oBAAoB;AAClG,8CAA8CA,oBAAoB;AAClE,0CAA0C,GAChC,EAAE;MACN,OAAO;AACb;AACA,oBAAoBiE,UAAU,CAACC,CAAC,CAACtB,IAAI,CAAC;AACtC,YAAYqB,UAAU,CAAC,GAAGC,CAAC,CAACc,QAAQ,KAAKd,CAAC,CAACe,UAAU,EAAE,CAAC;AACxD,YAAYhB,UAAU,CAACC,CAAC,CAACgB,OAAO,CAAC;AACjC,YAAYjB,UAAU,EAAAY,mBAAA,IAAAC,WAAA,GAACZ,CAAC,CAACiB,QAAQ,cAAAL,WAAA,uBAAVA,WAAA,CAAYM,OAAO,cAAAP,mBAAA,cAAAA,mBAAA,GAAI,EAAE,CAAC;AACjD,YAAYE,GAAG;AACf;AACA,OAAO;IACH,CAAC,EAAE,CAAC;IAEJ,MAAMM,IAAI,GAAG;AACjB;AACA,UAAUb,OAAO,GAAGE,QAAQ,GAAGC,OAAO,GAAGC,OAAO;AAChD;AACA,KAAK;IAED,MAAMU,KAAK,GAAG,CACZf,GAAG,GAAIA,GAAG,CAACE,QAAQ,CAAC,GAAG,CAAC,GAAGF,GAAG,GAAG,GAAGA,GAAG,GAAG,GAAI,EAAE,EAChDjE,YAAY,EACZQ,mBAAmB,GAAG,GAAGA,mBAAmB,GAAG,GAAG,EAAE,EACpDQ,iBAAiB,GACb,CACEA,iBAAiB,CAACsB,IAAI,EACtB,GAAGtB,iBAAiB,CAAC0D,QAAQ,KAAK1D,iBAAiB,CAAC2D,UAAU,EAAE,EAChE3D,iBAAiB,CAAC4D,OAAO,GAAAnB,qBAAA,IAAAC,sBAAA,GACzB1C,iBAAiB,CAAC6D,QAAQ,cAAAnB,sBAAA,uBAA1BA,sBAAA,CAA4BoB,OAAO,cAAArB,qBAAA,cAAAA,qBAAA,GAAI,EAAE,CAC1C,CAACwB,MAAM,CAACC,OAAO,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,GAC5B,EAAE,CACP,CACEF,MAAM,CAAErB,CAAC,IAAKA,CAAC,IAAIA,CAAC,CAACG,IAAI,CAAC,CAAC,CAACqB,MAAM,GAAG,CAAC,CAAC,CACvCD,IAAI,CAAC,MAAM,CAAC;IAEf,OAAO;MAAEJ,IAAI;MAAEC;IAAM,CAAC;EACxB,CAAC,EAAE,CAAC1E,kBAAkB,EAAEI,SAAS,EAAEV,YAAY,EAAEQ,mBAAmB,EAAEQ,iBAAiB,EAAEE,iBAAiB,CAAC,CAAC;EAE5G,MAAMmE,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7B,IAAI;MACF,MAAMzG,SAAS,CAAC0G,SAAS,CAAC9B,QAAQ,CAACuB,IAAI,CAAC;MACxC3D,SAAS,CAAC;QAAEmB,OAAO,EAAErD,OAAO,CAACqG,iBAAiB;QAAE9C,OAAO,EAAE;MAAU,CAAC,CAAC;IACvE,CAAC,CAAC,OAAOV,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,+BAA+B,EAAEF,GAAG,CAAC;IACrD;EACF,CAAC;EAED,oBACE1C,OAAA;IACEmG,KAAK,EAAE;MACLC,OAAO,EAAE,MAAM;MACfC,MAAM,EAAE,QAAQ;MAChBC,OAAO,EAAE,MAAM;MACfC,SAAS,EAAE,YAAY;MACvBC,KAAK,EAAE,MAAM,CAAmB;MAClC;MACA;IACA,CAAE;IAAAC,QAAA,gBAGFzG,OAAA;MACEmG,KAAK,EAAE;QACL;QACAK,KAAK,EAAE,SAASvG,cAAc,aAAaC,cAAc,KAAK;QAC9DwG,IAAI,EAAE,UAAU;QAChBC,WAAW,EAAE,aAAahH,OAAO,CAACiH,OAAO,EAAE;QAC3CC,YAAY,EAAE1G,MAAM;QACpB2G,SAAS,EAAE,MAAM;QAAiB;QAClCC,SAAS,EAAE,QAAQ;QAAe;QAClCC,SAAS,EAAE,CAAC,CAAsB;MACpC,CAAE;MAAAP,QAAA,eAEFzG,OAAA,CAACR,YAAY;QACXyH,YAAY,GAAAzG,qBAAA,GAAEC,gBAAgB,aAAhBA,gBAAgB,uBAAhBA,gBAAgB,CAAEwC,IAAI,cAAAzC,qBAAA,cAAAA,qBAAA,GAAI,IAAK;QAC7C0G,gBAAgB,EAAErE;MAAqB;QAAAsE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACxC;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC,eAGNtH,OAAA;MACEmG,KAAK,EAAE;QACLO,IAAI,EAAE,UAAU;QAChBa,QAAQ,EAAE,CAAC;QAAuB;QAClCC,WAAW,EAAErH,MAAM;QACnB2G,SAAS,EAAE,MAAM;QAAiB;QAClCC,SAAS,EAAE,QAAQ,CAAe;MACpC,CAAE;MAAAN,QAAA,gBAGFzG,OAAA;QACEmG,KAAK,EAAE;UACLC,OAAO,EAAE,MAAM;UACfqB,mBAAmB,EAAE,uBAAuB;UAC5CC,GAAG,EAAE,CAAC;UACNC,YAAY,EAAE,EAAE;UAChBC,UAAU,EAAE;QAAM,CAAE;QAAAnB,QAAA,gBACtBzG,OAAA;UAAAyG,QAAA,gBACEzG,OAAA;YACE6H,SAAS,EAAI/H,QAAQ,CAACgI,QAAU;YAAArB,QAAA,EACjC;UAED;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAERtH,OAAA;YACE+H,KAAK,EAAE9G,kBAAmB;YAC1B+G,QAAQ,EAAGC,CAAC,IAAK/G,qBAAqB,CAAC+G,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;YACvDF,SAAS,EAAI/H,QAAQ,CAACqI,MAAQ;YAAA1B,QAAA,gBAE9BzG,OAAA;cAAQ+H,KAAK,EAAC,EAAE;cAAAtB,QAAA,EAAC;YAAQ;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,EACjCzG,WAAW,CAACuH,GAAG,CAAE7D,CAAC,iBAAKvE,OAAA;cAAgB+H,KAAK,EAAExD,CAAE;cAAAkC,QAAA,EAAElC;YAAC,GAAfA,CAAC;cAAA4C,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAuB,CAAC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACzD,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC,eAGNtH,OAAA;UAAAyG,QAAA,gBACEzG,OAAA;YACE6H,SAAS,EAAI/H,QAAQ,CAACgI,QAAU;YAAArB,QAAA,EACjC;UAED;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAERtH,OAAA;YACEqI,IAAI,EAAC,MAAM;YACXN,KAAK,EAAE1G,SAAU;YACjB2G,QAAQ,EAAGC,CAAC,IAAK3G,YAAY,CAAC2G,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;YAC9CO,WAAW,EAAC,YAAY;YACxBT,SAAS,EAAI/H,QAAQ,CAACyI;UAAO;YAAApB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC9B,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAGNtH,OAAA;QAAKmG,KAAK,EAAE;UAAEwB,YAAY,EAAE;QAAG,CAAE;QAAAlB,QAAA,gBAC/BzG,OAAA;UACE6H,SAAS,EAAI/H,QAAQ,CAACgI,QAAU;UAAArB,QAAA,EACjC;QAED;UAAAU,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eAERtH,OAAA;UACImG,KAAK,EAAE;YACLd,QAAQ,EAAE;YACV;YACA;UACF,CAAE;UAAAoB,QAAA,gBAGFzG,OAAA;YACEmG,KAAK,EAAE;cACLd,QAAQ,EAAE,UAAU;cACpBmD,GAAG,EAAE,CAAC;cACNC,KAAK,EAAE,CAAC;cACRrC,OAAO,EAAE,MAAM;cACfsB,GAAG,EAAE,CAAC;cACNgB,MAAM,EAAE;YACV,CAAE;YACF,cAAW,gBAAgB;YAAAjC,QAAA,gBAE3BzG,OAAA;cACEqI,IAAI,EAAC,QAAQ;cACbM,OAAO,EAAI3C,UAAY;cACvB6B,SAAS,EAAI/H,QAAQ,CAAC8I,OAAS;cAC/BC,KAAK,EAAC,qBAAqB;cAC3B,cAAW,qBAAqB;cAAApC,QAAA,eAEhCzG,OAAA,CAACP,UAAU;gBAAA0H,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACR,CAAC,eAETtH,OAAA;cACEqI,IAAI,EAAC,QAAQ;cACbM,OAAO,EAAI3F,kBAAoB;cAC/B8F,QAAQ,EAAI,CAACrI,gBAAkB;cAC/BoH,SAAS,EAAI/H,QAAQ,CAAC8I,OAAS;cAC/BC,KAAK,EAAC,uBAAuB;cAC7B,cAAW,uBAAuB;cAAApC,QAAA,eAElCzG,OAAA,CAACN,UAAU;gBAAAyH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAC;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACP,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC,eAGNtH,OAAA;YACE+H,KAAK,EAAEpH,YAAa;YACpBqH,QAAQ,EAAGC,CAAC,IAAKrH,eAAe,CAACqH,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;YACjDO,WAAW,EAAE7H,gBAAgB,GAAG,EAAE,GAAG,4BAA6B;YAClEsI,QAAQ,EAAE,CAACtI,gBAAiB;YAC5BuI,IAAI,EAAC,MAAM;YACX7C,KAAK,EAAE;cACLI,SAAS,EAAE,YAAY;cAAG;cAC1BC,KAAK,EAAE,MAAM;cACbyC,QAAQ,EAAE,MAAM;cAChBjC,SAAS,EAAE5G,iBAAiB;cAC5B8I,SAAS,EAAE,MAAM;cACjB5C,OAAO,EAAE,qBAAqB;cAAE;cAChC6C,YAAY,EAAE,CAAC;cACfC,MAAM,EAAE,aAAazJ,OAAO,CAACyJ,MAAM,EAAE;cACrCC,MAAM,EAAE,UAAU;cAClBC,UAAU,EAAE,UAAU;cACtBC,YAAY,EAAE,UAAU;cACxBC,SAAS,EAAE,YAAY;cACvBC,UAAU,EAAE,0DAA0D;cACtEC,QAAQ,EAAE,EAAE;cACZC,UAAU,EAAE,GAAG;cACfC,UAAU,EAAEnJ,gBAAgB,GAAG,MAAM,GAAG;YAC1C;UAAE;YAAA0G,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAGNtH,OAAA;QACEmG,KAAK,EAAE;UACLC,OAAO,EAAE,MAAM;UACfqB,mBAAmB,EAAE,6BAA6B;UAClDC,GAAG,EAAE,CAAC;UACNC,YAAY,EAAE;QAChB,CAAE;QAAAlB,QAAA,gBAEFzG,OAAA;UAAAyG,QAAA,gBACEzG,OAAA;YACE6H,SAAS,EAAI/H,QAAQ,CAACgI,QAAU;YAAArB,QAAA,EACjC;UAED;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eACRtH,OAAA;YACE+H,KAAK,EAAE5G,mBAAoB;YAC3B6G,QAAQ,EAAGC,CAAC,IAAK7G,sBAAsB,CAAC6G,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;YACxDF,SAAS,EAAI/H,QAAQ,CAACqI,MAAQ;YAAA1B,QAAA,gBAE9BzG,OAAA;cAAQ+H,KAAK,EAAC,EAAE;cAAAtB,QAAA,EAAC;YAAQ;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,EACjCvG,YAAY,CAACqH,GAAG,CAAEyB,CAAC,iBAAK7J,OAAA;cAAgB+H,KAAK,EAAE8B,CAAE;cAAApD,QAAA,EAAEoD;YAAC,GAAfA,CAAC;cAAA1C,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAuB,CAAC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC1D,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC,eAGNtH,OAAA;UAAAyG,QAAA,gBACEzG,OAAA;YACE6H,SAAS,EAAI/H,QAAQ,CAACgI,QAAU;YAAArB,QAAA,EACjC;UAED;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAERtH,OAAA;YACE+H,KAAK,EAAEtG,qBAAsB;YAC7BuG,QAAQ,EAAGC,CAAC,IAAKvG,wBAAwB,CAACuG,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE;YAC1DF,SAAS,EAAI/H,QAAQ,CAACqI,MAAQ;YAAA1B,QAAA,gBAE9BzG,OAAA;cAAQ+H,KAAK,EAAC,EAAE;cAAAtB,QAAA,EAAC;YAAQ;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,EACjC/F,cAAc,CAAC6G,GAAG,CAAE0B,CAAC,iBAAK9J,OAAA;cAAgB+H,KAAK,EAAE+B,CAAE;cAAArD,QAAA,EAAEqD;YAAC,GAAfA,CAAC;cAAA3C,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAuB,CAAC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC5D,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eACNtH,OAAA;QACEmG,KAAK,EAAE;UACL4D,SAAS,EAAE,aAAapK,OAAO,CAACiH,OAAO,EAAE;UACzCoD,SAAS,EAAE,MAAM;UACjBC,UAAU,EAAE,QAAQ;UACpBL,UAAU,EAAE,SAAS;UACrBT,YAAY,EAAE,CAAC;UACf7C,OAAO,EAAE;QACX,CAAE;QAAAG,QAAA,gBAEFzG,OAAA;UACEmG,KAAK,EAAE;YACLC,OAAO,EAAE,MAAM;YACf8D,cAAc,EAAE,eAAe;YAC/BtC,UAAU,EAAE,QAAQ;YACpBuC,MAAM,EAAE;UACV,CAAE;UACFxB,OAAO,EAAEA,CAAA,KAAM1G,cAAc,CAACI,IAAI,IAAI,CAACA,IAAI,CAAE;UAAAoE,QAAA,gBAE7CzG,OAAA;YAAKmG,KAAK,EAAE;cAAEC,OAAO,EAAE,MAAM;cAAEwB,UAAU,EAAE,QAAQ;cAAEF,GAAG,EAAE;YAAS,CAAE;YAAAjB,QAAA,gBACnEzG,OAAA;cAAM6H,SAAS,EAAE/H,QAAQ,CAACgI,QAAS;cAAArB,QAAA,EAAC;YAAO;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAClDtH,OAAA;cACEmG,KAAK,EAAE;gBACLC,OAAO,EAAE,cAAc;gBACvBgE,UAAU,EAAE,qBAAqB;gBACjCC,SAAS,EAAErI,WAAW,GAAG,eAAe,GAAG;cAC7C,CAAE;cAAAyE,QAAA,EACH;YAED;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACJ,CAAC,eACNtH,OAAA;YACEqI,IAAI,EAAC,QAAQ;YACbM,OAAO,EAAGV,CAAC,IAAK;cACdA,CAAC,CAACqC,eAAe,CAAC,CAAC,CAAC,CAAC;cACrBtE,UAAU,CAAC,CAAC;YACd,CAAE;YACF6B,SAAS,EAAE/H,QAAQ,CAAC8I,OAAQ;YAC5BC,KAAK,EAAC,qBAAqB;YAC3B,cAAW,qBAAqB;YAAApC,QAAA,eAEhCzG,OAAA,CAACP,UAAU;cAAA0H,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACR,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC,EAELtF,WAAW,iBACVhC,OAAA;UACEmG,KAAK,EAAE;YACL6D,SAAS,EAAE,MAAM;YACjB1D,OAAO,EAAE,MAAM;YACf8C,MAAM,EAAE,aAAazJ,OAAO,CAACyJ,MAAM,EAAE;YACrCD,YAAY,EAAE,CAAC;YACfS,UAAU,EAAE,MAAM;YAClBH,UAAU,EAAE,YAAY;YACxBc,KAAK,EAAE;UACT,CAAE;UACFC,uBAAuB,EAAE;YAAEC,MAAM,EAAEtG,QAAQ,CAACuB;UAAK;QAAE;UAAAyB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACpD,CACF;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAAC/G,EAAA,CA1duBD,iBAAiB;EAAA,QAoBjBV,QAAQ;AAAA;AAAA8K,EAAA,GApBRpK,iBAAiB;AAAA,IAAAoK,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}