{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lhaveman\\\\email-generator\\\\src\\\\views\\\\EmailCompilerView.tsx\",\n  _s = $RefreshSig$();\n// src/views/EmailCompilerView/EmailCompilerView.tsx\nimport React, { useEffect, useState, useMemo } from 'react';\nimport { core } from '@tauri-apps/api';\nimport clipboard from 'tauri-plugin-clipboard-api';\nimport TemplateList from '../components/TemplateList/TemplateList';\nimport { CopyIcon20 } from '../ui/icons';\nimport { COLOURS } from '../ui/theme/theme';\nimport { useToast } from '../ui/toast';\nimport { STRINGS } from '../ui/strings';\nimport viewBtn from './SignatureView/SignatureView.module.css'; // reuse icon button styles\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LEFT_MIN_WIDTH = 220;\nconst LEFT_MAX_WIDTH = 350;\nconst GUTTER = '1rem';\nconst EDITOR_MIN_HEIGHT = 220;\nconst SIGNATURE_LOGO_WIDTH = 300;\nexport default function EmailCompilerView() {\n  _s();\n  var _selectedTemplate$nam;\n  // Left column selection\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\n\n  // Editor body\n  const [templateBody, setTemplateBody] = useState('');\n\n  // Salutation / Valediction / Recipient\n  const [salutations, setSalutations] = useState([]);\n  const [valedictions, setValedictions] = useState([]);\n  const [selectedSalutation, setSelectedSalutation] = useState('');\n  const [selectedValediction, setSelectedValediction] = useState('');\n  const [recipient, setRecipient] = useState('');\n\n  // Signatures\n  const [signatureNames, setSignatureNames] = useState([]);\n  const [selectedSignatureName, setSelectedSignatureName] = useState('');\n  const [selectedSignature, setSelectedSignature] = useState(null);\n  const [signatureImageB64, setSignatureImageB64] = useState(null);\n  const {\n    showToast\n  } = useToast();\n\n  // Load salutations, valedictions, and signature names\n  useEffect(() => {\n    core.invoke('load_salutations').then(setSalutations).catch(() => setSalutations(['Hello', 'Hi', 'Dear {name}', 'Good morning']));\n    core.invoke('load_valedictions').then(setValedictions).catch(() => setValedictions(['Best regards', 'Sincerely', 'Kind regards', 'Thanks']));\n    core.invoke('load_signatures').then(setSignatureNames).catch(err => console.error('Failed to load signatures', err));\n  }, []);\n\n  // Handle template selection from the list\n  const handleSelectTemplate = tpl => {\n    setSelectedTemplate(tpl);\n    setTemplateBody(tpl.content);\n  };\n\n  // Persist changes to template body\n  const handleSaveTemplate = async () => {\n    if (!selectedTemplate) return;\n    try {\n      await core.invoke('save_template', {\n        name: selectedTemplate.name,\n        content: templateBody\n      });\n      showToast({\n        message: STRINGS.savedChanges,\n        variant: 'success'\n      });\n      // reflect last modified locally\n      setSelectedTemplate(prev => prev ? {\n        ...prev,\n        content: templateBody,\n        last_modified: new Date().toISOString()\n      } : prev);\n    } catch (err) {\n      console.error('Failed to save template', err);\n    }\n  };\n\n  // Load full signature when selection changes\n  useEffect(() => {\n    if (!selectedSignatureName) {\n      setSelectedSignature(null);\n      setSignatureImageB64(null);\n      return;\n    }\n    core.invoke('load_signature_file', {\n      name: selectedSignatureName\n    }).then(sig => {\n      setSelectedSignature(sig);\n      if (sig.image_filename) {\n        core.invoke('get_signature_image_base64', {\n          filename: sig.image_filename\n        }).then(setSignatureImageB64).catch(() => setSignatureImageB64(null));\n      } else {\n        setSignatureImageB64(null);\n      }\n    }).catch(err => console.error('Failed to load signature file', err));\n  }, [selectedSignatureName]);\n\n  // Compose HTML + plaintext\n  const composed = useMemo(() => {\n    var _selectedSignature$lo, _selectedSignature$lo2;\n    const escapeHtml = s => s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n    const nl2br = s => escapeHtml(s).replace(/\\r?\\n/g, '<br/>');\n    const sal = selectedSalutation ? selectedSalutation.includes('{name}') ? selectedSalutation.replace('{name}', recipient || '').trim() : selectedSalutation : '';\n    const salHtml = sal ? `<p>${nl2br(sal)}${sal.endsWith(',') ? '' : ','}</p>` : '';\n    const bodyHtml = `<div>${nl2br(templateBody)}</div>`;\n    const valHtml = selectedValediction ? `<p style=\"margin-top:1rem;\">${nl2br(selectedValediction)}${selectedValediction.endsWith(',') ? '' : ','}</p>` : '';\n    const sigHtml = ((_s$location$address, _s$location) => {\n      if (!selectedSignature) return '';\n      const s = selectedSignature;\n      const img = signatureImageB64 ? `<img src=\"data:image/png;base64,${signatureImageB64}\" width=\"${SIGNATURE_LOGO_WIDTH}\"\n                 style=\"display:block;width:${SIGNATURE_LOGO_WIDTH}px;height:auto;margin-top:1rem;border:0;outline:0;text-decoration:none;\"\n                 alt=\"Signature image\" />` : '';\n      return `\n        <div>\n          <strong>${escapeHtml(s.name)}</strong><br/>\n          ${escapeHtml(`${s.position}, ${s.department}`)}<br/>\n          ${escapeHtml(s.company)}<br/>\n          ${escapeHtml((_s$location$address = (_s$location = s.location) === null || _s$location === void 0 ? void 0 : _s$location.address) !== null && _s$location$address !== void 0 ? _s$location$address : '')}\n          ${img}\n        </div>\n      `;\n    })();\n    const html = `\n      <div style=\"font-family:-apple-system, Segoe UI, Roboto, Arial, sans-serif; color:#111827;\">\n        ${salHtml}${bodyHtml}${valHtml}${sigHtml}\n      </div>\n    `;\n    const plain = [sal ? sal.endsWith(',') ? sal : `${sal},` : '', templateBody, selectedValediction ? `${selectedValediction},` : '', selectedSignature ? [selectedSignature.name, `${selectedSignature.position}, ${selectedSignature.department}`, selectedSignature.company, (_selectedSignature$lo = (_selectedSignature$lo2 = selectedSignature.location) === null || _selectedSignature$lo2 === void 0 ? void 0 : _selectedSignature$lo2.address) !== null && _selectedSignature$lo !== void 0 ? _selectedSignature$lo : ''].filter(Boolean).join('\\n') : ''].filter(s => s && s.trim().length > 0).join('\\n\\n');\n    return {\n      html,\n      plain\n    };\n  }, [selectedSalutation, recipient, templateBody, selectedValediction, selectedSignature, signatureImageB64]);\n  const handleCopy = async () => {\n    try {\n      await clipboard.writeHtml(composed.html);\n      //await clipboard.writeText(composed.plain);\n      showToast({\n        message: STRINGS.copiedToClipboard,\n        variant: 'success'\n      });\n    } catch (err) {\n      console.error('Failed to copy composed email', err);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      height: '100dvh',\n      padding: '1rem',\n      boxSizing: 'border-box',\n      width: '100%' // helps avoid accidental expansion past viewport\n      // NOTE: do NOT set overflowX:'hidden' here if you want page-level horizontal\n      // scroll to be possible; keep default so only the *page* can scroll sideways.\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        // Give the column a responsive width that never exceeds LEFT_MAX_WIDTH\n        width: `clamp(${LEFT_MIN_WIDTH}px, 26vw, ${LEFT_MAX_WIDTH}px)`,\n        flex: '0 0 auto',\n        borderRight: `1px solid ${COLOURS.divider}`,\n        paddingRight: GUTTER,\n        overflowY: 'auto',\n        // independent vertical scroll\n        overflowX: 'hidden',\n        // never show a horizontal scrollbar here\n        minHeight: 0 // required for scroll inside flex child\n      },\n      children: /*#__PURE__*/_jsxDEV(TemplateList, {\n        selectedName: (_selectedTemplate$nam = selectedTemplate === null || selectedTemplate === void 0 ? void 0 : selectedTemplate.name) !== null && _selectedTemplate$nam !== void 0 ? _selectedTemplate$nam : null,\n        onSelectTemplate: handleSelectTemplate\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: '1 1 auto',\n        minWidth: 0,\n        // <-- CRUCIAL: allow shrinking within flex\n        paddingLeft: GUTTER,\n        overflowY: 'auto',\n        // independent vertical scroll\n        overflowX: 'hidden' // never show a horizontal scrollbar here\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: '1fr 1fr auto',\n          gap: 8,\n          marginBottom: 12,\n          alignItems: 'end'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'block',\n              fontSize: 12,\n              color: '#374151',\n              marginBottom: 4\n            },\n            children: \"Salutation\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: selectedSalutation,\n            onChange: e => setSelectedSalutation(e.target.value),\n            style: {\n              width: '100%',\n              padding: '6px 8px',\n              borderRadius: 6,\n              border: `1px solid ${COLOURS.border}`\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"\\u2014 none \\u2014\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 15\n            }, this), salutations.map(s => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: s,\n              children: s\n            }, s, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 39\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'block',\n              fontSize: 12,\n              color: '#374151',\n              marginBottom: 4\n            },\n            children: [\"Recipient (for \", '{name}', \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: recipient,\n            onChange: e => setRecipient(e.target.value),\n            placeholder: \"e.g., Alex\",\n            style: {\n              width: '100%',\n              padding: '6px 8px',\n              borderRadius: 6,\n              border: `1px solid ${COLOURS.border}`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            fontSize: 12,\n            color: '#374151',\n            marginBottom: 4\n          },\n          children: \"Template body\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'relative'\n            // allow the overlayed toolbar to stay within rounded corners if you wish\n            // overflow: 'hidden',\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: 'absolute',\n              top: 8,\n              right: 8,\n              display: 'flex',\n              gap: 8,\n              zIndex: 1\n            },\n            \"aria-label\": \"Editor toolbar\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: handleCopy,\n              className: viewBtn.iconBtn,\n              title: \"Copy composed email\",\n              \"aria-label\": \"Copy composed email\",\n              children: /*#__PURE__*/_jsxDEV(CopyIcon20, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: handleSaveTemplate,\n              disabled: !selectedTemplate\n              // You can style this as an icon button too if you have one\n              ,\n              children: \"Save\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: templateBody,\n            onChange: e => setTemplateBody(e.target.value),\n            placeholder: selectedTemplate ? '' : 'Select a template to edit…',\n            readOnly: !selectedTemplate,\n            wrap: \"soft\",\n            style: {\n              boxSizing: 'border-box',\n              // prevents right-edge overflow\n              width: '100%',\n              maxWidth: '100%',\n              minHeight: EDITOR_MIN_HEIGHT,\n              maxHeight: '70vh',\n              padding: '44px 12px 12px 12px',\n              // <-- extra top padding for toolbar clearance\n              borderRadius: 8,\n              border: `1px solid ${COLOURS.border}`,\n              resize: 'vertical',\n              whiteSpace: 'pre-wrap',\n              overflowWrap: 'anywhere',\n              wordBreak: 'break-word',\n              fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Consolas, monospace',\n              fontSize: 14,\n              lineHeight: 1.5,\n              background: selectedTemplate ? '#fff' : '#f9fafb'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: '1fr',\n          gap: 8,\n          marginBottom: 12\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'block',\n              fontSize: 12,\n              color: '#374151',\n              marginBottom: 4\n            },\n            children: \"Valediction\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: selectedValediction,\n            onChange: e => setSelectedValediction(e.target.value),\n            style: {\n              width: '100%',\n              padding: '6px 8px',\n              borderRadius: 6,\n              border: `1px solid ${COLOURS.border}`\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"\\u2014 none \\u2014\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 15\n            }, this), valedictions.map(v => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: v,\n              children: v\n            }, v, false, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 40\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: '1fr',\n          gap: 8\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'block',\n              fontSize: 12,\n              color: '#374151',\n              marginBottom: 4\n            },\n            children: \"Signature\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: selectedSignatureName,\n            onChange: e => setSelectedSignatureName(e.target.value),\n            style: {\n              width: '100%',\n              padding: '6px 8px',\n              borderRadius: 6,\n              border: `1px solid ${COLOURS.border}`\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"\\u2014 none \\u2014\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 15\n            }, this), signatureNames.map(n => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: n,\n              children: n\n            }, n, false, {\n              fileName: _jsxFileName,\n              lineNumber: 346,\n              columnNumber: 42\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 180,\n    columnNumber: 5\n  }, this);\n}\n_s(EmailCompilerView, \"V5HQaZggT+lWob8JRd6gYuJ2NyA=\", false, function () {\n  return [useToast];\n});\n_c = EmailCompilerView;\nvar _c;\n$RefreshReg$(_c, \"EmailCompilerView\");","map":{"version":3,"names":["React","useEffect","useState","useMemo","core","clipboard","TemplateList","CopyIcon20","COLOURS","useToast","STRINGS","viewBtn","jsxDEV","_jsxDEV","LEFT_MIN_WIDTH","LEFT_MAX_WIDTH","GUTTER","EDITOR_MIN_HEIGHT","SIGNATURE_LOGO_WIDTH","EmailCompilerView","_s","_selectedTemplate$nam","selectedTemplate","setSelectedTemplate","templateBody","setTemplateBody","salutations","setSalutations","valedictions","setValedictions","selectedSalutation","setSelectedSalutation","selectedValediction","setSelectedValediction","recipient","setRecipient","signatureNames","setSignatureNames","selectedSignatureName","setSelectedSignatureName","selectedSignature","setSelectedSignature","signatureImageB64","setSignatureImageB64","showToast","invoke","then","catch","err","console","error","handleSelectTemplate","tpl","content","handleSaveTemplate","name","message","savedChanges","variant","prev","last_modified","Date","toISOString","sig","image_filename","filename","composed","_selectedSignature$lo","_selectedSignature$lo2","escapeHtml","s","replace","nl2br","sal","includes","trim","salHtml","endsWith","bodyHtml","valHtml","sigHtml","_s$location$address","_s$location","img","position","department","company","location","address","html","plain","filter","Boolean","join","length","handleCopy","writeHtml","copiedToClipboard","style","display","height","padding","boxSizing","width","children","flex","borderRight","divider","paddingRight","overflowY","overflowX","minHeight","selectedName","onSelectTemplate","fileName","_jsxFileName","lineNumber","columnNumber","minWidth","paddingLeft","gridTemplateColumns","gap","marginBottom","alignItems","fontSize","color","value","onChange","e","target","borderRadius","border","map","type","placeholder","top","right","zIndex","onClick","className","iconBtn","title","disabled","readOnly","wrap","maxWidth","maxHeight","resize","whiteSpace","overflowWrap","wordBreak","fontFamily","lineHeight","background","v","n","_c","$RefreshReg$"],"sources":["C:/Users/lhaveman/email-generator/src/views/EmailCompilerView.tsx"],"sourcesContent":["// src/views/EmailCompilerView/EmailCompilerView.tsx\r\nimport React, { useEffect, useState, useMemo } from 'react';\r\nimport { core } from '@tauri-apps/api';\r\nimport clipboard from 'tauri-plugin-clipboard-api';\r\nimport TemplateList, { TemplateFile } from '../components/TemplateList/TemplateList';\r\n\r\nimport { CopyIcon20, SaveIcon20 } from '../ui/icons';\r\nimport { COLOURS } from '../ui/theme/theme';\r\nimport { useToast } from '../ui/toast';\r\nimport { STRINGS } from '../ui/strings';\r\nimport viewBtn from './SignatureView/SignatureView.module.css' // reuse icon button styles\r\n\r\ntype SignatureFile = {\r\n  signature_name: string;\r\n  name: string;\r\n  position: string;\r\n  department: string;\r\n  company: string;\r\n  location: { name: string; address: string };\r\n  image_filename: string | null;\r\n};\r\n\r\nconst LEFT_MIN_WIDTH = 220;\r\nconst LEFT_MAX_WIDTH = 350;\r\nconst GUTTER = '1rem';\r\nconst EDITOR_MIN_HEIGHT = 220;\r\nconst SIGNATURE_LOGO_WIDTH = 300;\r\n\r\nexport default function EmailCompilerView() {\r\n  // Left column selection\r\n  const [selectedTemplate, setSelectedTemplate] = useState<TemplateFile | null>(null);\r\n\r\n  // Editor body\r\n  const [templateBody, setTemplateBody] = useState('');\r\n\r\n  // Salutation / Valediction / Recipient\r\n  const [salutations, setSalutations] = useState<string[]>([]);\r\n  const [valedictions, setValedictions] = useState<string[]>([]);\r\n  const [selectedSalutation, setSelectedSalutation] = useState<string>('');\r\n  const [selectedValediction, setSelectedValediction] = useState<string>('');\r\n  const [recipient, setRecipient] = useState<string>('');\r\n\r\n  // Signatures\r\n  const [signatureNames, setSignatureNames] = useState<string[]>([]);\r\n  const [selectedSignatureName, setSelectedSignatureName] = useState<string>('');\r\n  const [selectedSignature, setSelectedSignature] = useState<SignatureFile | null>(null);\r\n  const [signatureImageB64, setSignatureImageB64] = useState<string | null>(null);\r\n\r\n  const { showToast } = useToast();\r\n\r\n  // Load salutations, valedictions, and signature names\r\n  useEffect(() => {\r\n    core.invoke<string[]>('load_salutations')\r\n      .then(setSalutations)\r\n      .catch(() => setSalutations(['Hello', 'Hi', 'Dear {name}', 'Good morning']));\r\n\r\n    core.invoke<string[]>('load_valedictions')\r\n      .then(setValedictions)\r\n      .catch(() => setValedictions(['Best regards', 'Sincerely', 'Kind regards', 'Thanks']));\r\n\r\n    core.invoke<string[]>('load_signatures')\r\n      .then(setSignatureNames)\r\n      .catch((err) => console.error('Failed to load signatures', err));\r\n  }, []);\r\n\r\n  // Handle template selection from the list\r\n  const handleSelectTemplate = (tpl: TemplateFile) => {\r\n    setSelectedTemplate(tpl);\r\n    setTemplateBody(tpl.content);\r\n  };\r\n\r\n  // Persist changes to template body\r\n  const handleSaveTemplate = async () => {\r\n    if (!selectedTemplate) return;\r\n    try {\r\n      await core.invoke('save_template', { name: selectedTemplate.name, content: templateBody });\r\n      showToast({ message: STRINGS.savedChanges, variant: 'success' });\r\n      // reflect last modified locally\r\n      setSelectedTemplate((prev) =>\r\n        prev ? { ...prev, content: templateBody, last_modified: new Date().toISOString() } : prev\r\n      );\r\n    } catch (err) {\r\n      console.error('Failed to save template', err);\r\n    }\r\n  };\r\n\r\n  // Load full signature when selection changes\r\n  useEffect(() => {\r\n    if (!selectedSignatureName) {\r\n      setSelectedSignature(null);\r\n      setSignatureImageB64(null);\r\n      return;\r\n    }\r\n    core.invoke<SignatureFile>('load_signature_file', { name: selectedSignatureName })\r\n      .then((sig) => {\r\n        setSelectedSignature(sig);\r\n        if (sig.image_filename) {\r\n          core.invoke<string>('get_signature_image_base64', { filename: sig.image_filename })\r\n            .then(setSignatureImageB64)\r\n            .catch(() => setSignatureImageB64(null));\r\n        } else {\r\n          setSignatureImageB64(null);\r\n        }\r\n      })\r\n      .catch((err) => console.error('Failed to load signature file', err));\r\n  }, [selectedSignatureName]);\r\n\r\n  // Compose HTML + plaintext\r\n  const composed = useMemo(() => {\r\n    const escapeHtml = (s: string) =>\r\n      s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n\r\n    const nl2br = (s: string) => escapeHtml(s).replace(/\\r?\\n/g, '<br/>');\r\n\r\n    const sal = selectedSalutation\r\n      ? selectedSalutation.includes('{name}')\r\n        ? selectedSalutation.replace('{name}', recipient || '').trim()\r\n        : selectedSalutation\r\n      : '';\r\n\r\n    const salHtml = sal ? `<p>${nl2br(sal)}${sal.endsWith(',') ? '' : ','}</p>` : '';\r\n    const bodyHtml = `<div>${nl2br(templateBody)}</div>`;\r\n    const valHtml = selectedValediction ? `<p style=\"margin-top:1rem;\">${nl2br(selectedValediction)}${selectedValediction.endsWith(',') ? '' : ','}</p>` : '';\r\n\r\n    const sigHtml = (() => {\r\n      if (!selectedSignature) return '';\r\n      const s = selectedSignature;\r\n      const img = signatureImageB64\r\n        ? `<img src=\"data:image/png;base64,${signatureImageB64}\" width=\"${SIGNATURE_LOGO_WIDTH}\"\r\n                 style=\"display:block;width:${SIGNATURE_LOGO_WIDTH}px;height:auto;margin-top:1rem;border:0;outline:0;text-decoration:none;\"\r\n                 alt=\"Signature image\" />`\r\n        : '';\r\n      return `\r\n        <div>\r\n          <strong>${escapeHtml(s.name)}</strong><br/>\r\n          ${escapeHtml(`${s.position}, ${s.department}`)}<br/>\r\n          ${escapeHtml(s.company)}<br/>\r\n          ${escapeHtml(s.location?.address ?? '')}\r\n          ${img}\r\n        </div>\r\n      `;\r\n    })();\r\n\r\n    const html = `\r\n      <div style=\"font-family:-apple-system, Segoe UI, Roboto, Arial, sans-serif; color:#111827;\">\r\n        ${salHtml}${bodyHtml}${valHtml}${sigHtml}\r\n      </div>\r\n    `;\r\n\r\n    const plain = [\r\n      sal ? (sal.endsWith(',') ? sal : `${sal},`) : '',\r\n      templateBody,\r\n      selectedValediction ? `${selectedValediction},` : '',\r\n      selectedSignature\r\n        ? [\r\n            selectedSignature.name,\r\n            `${selectedSignature.position}, ${selectedSignature.department}`,\r\n            selectedSignature.company,\r\n            selectedSignature.location?.address ?? '',\r\n          ].filter(Boolean).join('\\n')\r\n        : '',\r\n    ]\r\n      .filter((s) => s && s.trim().length > 0)\r\n      .join('\\n\\n');\r\n\r\n    return { html, plain };\r\n  }, [selectedSalutation, recipient, templateBody, selectedValediction, selectedSignature, signatureImageB64]);\r\n\r\n  const handleCopy = async () => {\r\n    try {\r\n      await clipboard.writeHtml(composed.html);\r\n      //await clipboard.writeText(composed.plain);\r\n      showToast({ message: STRINGS.copiedToClipboard, variant: 'success' });\r\n    } catch (err) {\r\n      console.error('Failed to copy composed email', err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div \r\n      style={{ \r\n        display: 'flex', \r\n        height: '100dvh', \r\n        padding: '1rem',\r\n        boxSizing: 'border-box',\r\n        width: '100%',                  // helps avoid accidental expansion past viewport\r\n      // NOTE: do NOT set overflowX:'hidden' here if you want page-level horizontal\r\n      // scroll to be possible; keep default so only the *page* can scroll sideways.\r\n      }}\r\n    >\r\n      {/* LEFT: reuse TemplateList (Templates + search + favourites) */}\r\n      <div\r\n        style={{\r\n          // Give the column a responsive width that never exceeds LEFT_MAX_WIDTH\r\n          width: `clamp(${LEFT_MIN_WIDTH}px, 26vw, ${LEFT_MAX_WIDTH}px)`,\r\n          flex: '0 0 auto',\r\n          borderRight: `1px solid ${COLOURS.divider}`,\r\n          paddingRight: GUTTER,\r\n          overflowY: 'auto',                // independent vertical scroll\r\n          overflowX: 'hidden',              // never show a horizontal scrollbar here\r\n          minHeight: 0,                     // required for scroll inside flex child\r\n        }}\r\n      >\r\n        <TemplateList\r\n          selectedName={selectedTemplate?.name ?? null}\r\n          onSelectTemplate={handleSelectTemplate}\r\n        />\r\n      </div>\r\n\r\n      {/* RIGHT: Composer */}\r\n      <div \r\n        style={{ \r\n          flex: '1 1 auto', \r\n          minWidth: 0,                      // <-- CRUCIAL: allow shrinking within flex\r\n          paddingLeft: GUTTER,\r\n          overflowY: 'auto',                // independent vertical scroll\r\n          overflowX: 'hidden',              // never show a horizontal scrollbar here\r\n        }}\r\n      >\r\n        {/* Row 1: Salutation + Recipient + Copy */}\r\n        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr auto', gap: 8, marginBottom: 12, alignItems: 'end' }}>\r\n          <div>\r\n            <label style={{ display: 'block', fontSize: 12, color: '#374151', marginBottom: 4 }}>Salutation</label>\r\n            <select\r\n              value={selectedSalutation}\r\n              onChange={(e) => setSelectedSalutation(e.target.value)}\r\n              style={{ width: '100%', padding: '6px 8px', borderRadius: 6, border: `1px solid ${COLOURS.border}` }}\r\n            >\r\n              <option value=\"\">— none —</option>\r\n              {salutations.map((s) => <option key={s} value={s}>{s}</option>)}\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label style={{ display: 'block', fontSize: 12, color: '#374151', marginBottom: 4 }}>Recipient (for {'{name}'})</label>\r\n            <input\r\n              type=\"text\"\r\n              value={recipient}\r\n              onChange={(e) => setRecipient(e.target.value)}\r\n              placeholder=\"e.g., Alex\"\r\n              style={{ width: '100%', padding: '6px 8px', borderRadius: 6, border: `1px solid ${COLOURS.border}` }}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Row 2: Template editor + Save */}\r\n        <div style={{ marginBottom: 12 }}>\r\n          <label style={{ display: 'block', fontSize: 12, color: '#374151', marginBottom: 4 }}>\r\n            Template body\r\n          </label>\r\n\r\n          <div\r\n              style={{\r\n                position: 'relative',\r\n                // allow the overlayed toolbar to stay within rounded corners if you wish\r\n                // overflow: 'hidden',\r\n              }}\r\n            >\r\n              {/* Floating toolbar – visually inside the editor area */}\r\n              <div\r\n                style={{\r\n                  position: 'absolute',\r\n                  top: 8,\r\n                  right: 8,\r\n                  display: 'flex',\r\n                  gap: 8,\r\n                  zIndex: 1,\r\n                }}\r\n                aria-label=\"Editor toolbar\"\r\n              >\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleCopy}\r\n                  className={viewBtn.iconBtn}\r\n                  title=\"Copy composed email\"\r\n                  aria-label=\"Copy composed email\"\r\n                >\r\n                  <CopyIcon20 />\r\n                </button>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleSaveTemplate}\r\n                  disabled={!selectedTemplate}\r\n                  // You can style this as an icon button too if you have one\r\n                >\r\n                  Save\r\n                </button>\r\n              </div>\r\n\r\n              {/* The textarea gets extra top padding so text never hides under the toolbar */}\r\n              <textarea\r\n                value={templateBody}\r\n                onChange={(e) => setTemplateBody(e.target.value)}\r\n                placeholder={selectedTemplate ? '' : 'Select a template to edit…'}\r\n                readOnly={!selectedTemplate}\r\n                wrap=\"soft\"\r\n                style={{\r\n                  boxSizing: 'border-box',  // prevents right-edge overflow\r\n                  width: '100%',\r\n                  maxWidth: '100%',\r\n                  minHeight: EDITOR_MIN_HEIGHT,\r\n                  maxHeight: '70vh',\r\n                  padding: '44px 12px 12px 12px', // <-- extra top padding for toolbar clearance\r\n                  borderRadius: 8,\r\n                  border: `1px solid ${COLOURS.border}`,\r\n                  resize: 'vertical',\r\n                  whiteSpace: 'pre-wrap',\r\n                  overflowWrap: 'anywhere',\r\n                  wordBreak: 'break-word',\r\n                  fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Consolas, monospace',\r\n                  fontSize: 14,\r\n                  lineHeight: 1.5,\r\n                  background: selectedTemplate ? '#fff' : '#f9fafb',\r\n                }}\r\n              />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Row 3: Valediction */}\r\n        <div style={{ display: 'grid', gridTemplateColumns: '1fr', gap: 8, marginBottom: 12 }}>\r\n          <div>\r\n            <label style={{ display: 'block', fontSize: 12, color: '#374151', marginBottom: 4 }}>\r\n              Valediction\r\n            </label>\r\n            <select\r\n              value={selectedValediction}\r\n              onChange={(e) => setSelectedValediction(e.target.value)}\r\n              style={{ width: '100%', padding: '6px 8px', borderRadius: 6, border: `1px solid ${COLOURS.border}` }}\r\n            >\r\n              <option value=\"\">— none —</option>\r\n              {valedictions.map((v) => <option key={v} value={v}>{v}</option>)}\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Row 4: Signature */}\r\n        <div style={{ display: 'grid', gridTemplateColumns: '1fr', gap: 8 }}>\r\n          <div>\r\n            <label style={{ display: 'block', fontSize: 12, color: '#374151', marginBottom: 4 }}>Signature</label>\r\n            <select\r\n              value={selectedSignatureName}\r\n              onChange={(e) => setSelectedSignatureName(e.target.value)}\r\n              style={{ width: '100%', padding: '6px 8px', borderRadius: 6, border: `1px solid ${COLOURS.border}` }}\r\n            >\r\n              <option value=\"\">— none —</option>\r\n              {signatureNames.map((n) => <option key={n} value={n}>{n}</option>)}\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}